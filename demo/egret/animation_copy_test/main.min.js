var __reflect=this&&this.__reflect||function(e,t,a){e.__class__=t,a?a.push(t):a=[t],e.__types__=e.__types__?a.concat(e.__types__):a},__extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},BaseTest=function(e){function t(){var t=e.call(this)||this;return t._background=new egret.Shape,t._resources=[],t._resourceMap={},t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){t._background.graphics.beginFill(6710886,1),t._background.graphics.drawRect(0,0,t.stage.stageWidth,t.stage.stageHeight),t.addChild(t._background),t._loadResources()},t),t}return __extends(t,e),t.prototype._loadResources=function(){var e=this;this._loadCount=this._resources.length;for(var t=0,a=this._resources;t<a.length;t++){var s=a[t];RES.getResByUrl(s,function(t,a){e._resourceMap[a]=t,e._loadCount--,0===e._loadCount&&(RES.getRes=function(t){return e._resourceMap[t]},e._onStart())},this,s.indexOf(".dbbin")>0?RES.ResourceItem.TYPE_BIN:null)}},t}(egret.DisplayObjectContainer);__reflect(BaseTest.prototype,"BaseTest");var AnimationBaseTest=function(e){function t(){var t=e.call(this)||this;return t._resources.push("resource/assets/animation_base_test_ske.json","resource/assets/animation_base_test_tex.json","resource/assets/animation_base_test_tex.png"),t}return __extends(t,e),t.prototype._onStart=function(){var e=dragonBones.EgretFactory.factory;e.parseDragonBonesData(RES.getRes("resource/assets/animation_base_test_ske.json")),e.parseTextureAtlasData(RES.getRes("resource/assets/animation_base_test_tex.json"),RES.getRes("resource/assets/animation_base_test_tex.png")),this._armatureDisplay=e.buildArmatureDisplay("progressBar"),this._armatureDisplay.x=.5*this.stage.stageWidth,this._armatureDisplay.y=.5*this.stage.stageHeight,this._armatureDisplay.scaleX=this._armatureDisplay.scaleY=this.stage.stageWidth>=300?1:this.stage.stageWidth/330,this.addChild(this._armatureDisplay),this._armatureDisplay.addEventListener(dragonBones.EventObject.START,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.FADE_IN,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.FADE_IN_COMPLETE,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.FADE_OUT,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.FADE_OUT_COMPLETE,this._animationEventHandler,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.FRAME_EVENT,this._animationEventHandler,this),this._armatureDisplay.animation.play("idle",1),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this._touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._touchHandler,this);var t=new egret.TextField;t.size=20,t.textAlign=egret.HorizontalAlign.CENTER,t.text="Click to control animation play progress.",t.width=this.stage.stageWidth,t.x=0,t.y=this.stage.stageHeight-60,this.addChild(t)},t.prototype._touchHandler=function(e){var t=Math.min(Math.max((e.stageX-this._armatureDisplay.x+300*this._armatureDisplay.scaleX)/600*this._armatureDisplay.scaleX,0),1);switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:this._armatureDisplay.animation.gotoAndStopByProgress("idle",t);break;case egret.TouchEvent.TOUCH_END:this._armatureDisplay.animation.play();break;case egret.TouchEvent.TOUCH_MOVE:if(e.touchDown){var a=this._armatureDisplay.animation.getState("idle");a&&(a.currentTime=a.totalTime*t)}}},t.prototype._animationEventHandler=function(e){console.log(e.eventObject.animationState.name,e.type,e.eventObject.name?e.eventObject.name:"")},t}(BaseTest);__reflect(AnimationBaseTest.prototype,"AnimationBaseTest");var AnimationCopyTest=function(e){function t(){var t=e.call(this)||this;return t._resources.push("resource/assets/core_element/mecha_2903_ske.json","resource/assets/core_element/mecha_2903_tex.json","resource/assets/core_element/mecha_2903_tex.png"),t}return __extends(t,e),t.prototype._onStart=function(){var e=this,t=dragonBones.EgretFactory.factory;t.parseDragonBonesData(RES.getRes("resource/assets/core_element/mecha_2903_ske.json")),t.parseTextureAtlasData(RES.getRes("resource/assets/core_element/mecha_2903_tex.json"),RES.getRes("resource/assets/core_element/mecha_2903_tex.png")),this._armatureDisplayA=t.buildArmatureDisplay("mecha_2903"),this._armatureDisplayB=t.buildArmatureDisplay("mecha_2903b"),this._armatureDisplayC=t.buildArmatureDisplay("mecha_2903c"),this._armatureDisplayD=t.buildArmatureDisplay("mecha_2903d"),t.copyAnimationsToArmature(this._armatureDisplayA.armature,"mecha_2903d"),t.copyAnimationsToArmature(this._armatureDisplayB.armature,"mecha_2903d"),t.copyAnimationsToArmature(this._armatureDisplayC.armature,"mecha_2903d"),this.addChild(this._armatureDisplayA),this.addChild(this._armatureDisplayB),this.addChild(this._armatureDisplayC),this.addChild(this._armatureDisplayD),this._armatureDisplayA.x=.5*this.stage.stageWidth-350,this._armatureDisplayA.y=.5*this.stage.stageHeight+200,this._armatureDisplayB.x=.5*this.stage.stageWidth,this._armatureDisplayB.y=.5*this.stage.stageHeight+200,this._armatureDisplayC.x=.5*this.stage.stageWidth+350,this._armatureDisplayC.y=.5*this.stage.stageHeight+200,this._armatureDisplayD.x=.5*this.stage.stageWidth,this._armatureDisplayD.y=.5*this.stage.stageHeight-50,this.stage.addEventListener(egret.TouchEvent.TOUCH_END,function(){var t=e._armatureDisplayD.animation.lastAnimationName;if(t){var a=e._armatureDisplayD.animation.animationNames,s=(a.indexOf(t)+1)%a.length;e._armatureDisplayD.animation.play(a[s])}else e._armatureDisplayD.animation.play();t=e._armatureDisplayD.animation.lastAnimationName,e._armatureDisplayA.animation.play(t),e._armatureDisplayB.animation.play(t),e._armatureDisplayC.animation.play(t)},this);var a=new egret.TextField;a.size=20,a.textAlign=egret.HorizontalAlign.CENTER,a.text="Click to change animation.",a.width=this.stage.stageWidth,a.x=0,a.y=this.stage.stageHeight-60,this.addChild(a)},t}(BaseTest);__reflect(AnimationCopyTest.prototype,"AnimationCopyTest");var coreElement;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._left=!1,t._right=!1,t._bullets=[],t._resources.push("resource/assets/core_element/mecha_1502b_ske.json","resource/assets/core_element/mecha_1502b_tex.json","resource/assets/core_element/mecha_1502b_tex.png","resource/assets/core_element/skin_1502b_ske.json","resource/assets/core_element/skin_1502b_tex.json","resource/assets/core_element/skin_1502b_tex.png","resource/assets/core_element/weapon_1000_ske.json","resource/assets/core_element/weapon_1000_tex.json","resource/assets/core_element/weapon_1000_tex.png"),t}return __extends(t,e),t.prototype._onStart=function(){t.STAGE_WIDTH=this.stage.stageWidth,t.STAGE_HEIGHT=this.stage.stageHeight,t.GROUND=t.STAGE_HEIGHT-150,t.instance=this;var e=dragonBones.EgretFactory.factory;e.parseDragonBonesData(RES.getRes("resource/assets/core_element/mecha_1502b_ske.json")),e.parseTextureAtlasData(RES.getRes("resource/assets/core_element/mecha_1502b_tex.json"),RES.getRes("resource/assets/core_element/mecha_1502b_tex.png")),e.parseDragonBonesData(RES.getRes("resource/assets/core_element/skin_1502b_ske.json")),e.parseTextureAtlasData(RES.getRes("resource/assets/core_element/skin_1502b_tex.json"),RES.getRes("resource/assets/core_element/skin_1502b_tex.png")),e.parseDragonBonesData(RES.getRes("resource/assets/core_element/weapon_1000_ske.json")),e.parseTextureAtlasData(RES.getRes("resource/assets/core_element/weapon_1000_tex.json"),RES.getRes("resource/assets/core_element/weapon_1000_tex.png")),this._player=new a,this.stage.addEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this._touchHandler,this),document.addEventListener("keydown",this._keyHandler),document.addEventListener("keyup",this._keyHandler);var s=egret.sys.TouchHandler.prototype.onTouchMove;egret.sys.TouchHandler.prototype.onTouchMove=function(e,a,i){s.call(this,e,a,i),t.instance._player.aim(e,a)};var i=new egret.TextField;i.size=20,i.textAlign=egret.HorizontalAlign.CENTER,i.text="Press W/A/S/D to move. Press Q/E to switch weapons. Press SPACE to switch skin.\nMouse Move to aim. Click to fire.",i.width=t.STAGE_WIDTH,i.x=0,i.y=t.STAGE_HEIGHT-60,this.addChild(i)},t.prototype._touchHandler=function(e){this._player.aim(e.stageX,e.stageY),e.type===egret.TouchEvent.TOUCH_BEGIN?this._player.attack(!0):this._player.attack(!1)},t.prototype._keyHandler=function(e){var a="keydown"===e.type;switch(e.keyCode){case 37:case 65:t.instance._left=a,t.instance._updateMove(-1);break;case 39:case 68:t.instance._right=a,t.instance._updateMove(1);break;case 38:case 87:a&&t.instance._player.jump();break;case 83:case 40:t.instance._player.squat(a);break;case 81:a&&t.instance._player.switchWeaponR();break;case 69:a&&t.instance._player.switchWeaponL();break;case 32:a&&t.instance._player.switchSkin()}},t.prototype._enterFrameHandler=function(e){this._player.update();for(var t=this._bullets.length;t--;){var a=this._bullets[t];a.update()&&this._bullets.splice(t,1)}},t.prototype._updateMove=function(e){this._left&&this._right?this._player.move(e):this._left?this._player.move(-1):this._right?this._player.move(1):this._player.move(0)},t.prototype.addBullet=function(e){this._bullets.push(e)},t}(BaseTest);t.G=.6,e.Game=t,__reflect(t.prototype,"coreElement.Game");var a=function(){function e(){this._isJumpingA=!1,this._isJumpingB=!1,this._isSquating=!1,this._isAttackingA=!1,this._isAttackingB=!1,this._weaponRIndex=0,this._weaponLIndex=0,this._skinIndex=0,this._faceDir=1,this._aimDir=0,this._moveDir=0,this._aimRadian=0,this._speedX=0,this._speedY=0,this._aimState=null,this._walkState=null,this._attackState=null,this._target=new egret.Point,this._helpPoint=new egret.Point,this._armatureDisplay=dragonBones.EgretFactory.factory.buildArmatureDisplay("mecha_1502b"),this._armatureDisplay.x=.5*t.STAGE_WIDTH,this._armatureDisplay.y=t.GROUND,this._armature=this._armatureDisplay.armature,this._armature.eventDispatcher.addEvent(dragonBones.EventObject.FADE_IN_COMPLETE,this._animationEventHandler,this),this._armature.eventDispatcher.addEvent(dragonBones.EventObject.FADE_OUT_COMPLETE,this._animationEventHandler,this),this._armature.eventDispatcher.addEvent(dragonBones.EventObject.COMPLETE,this._animationEventHandler,this),this._weaponL=this._armature.getSlot("weapon_l").childArmature,this._weaponR=this._armature.getSlot("weapon_r").childArmature,this._weaponL.eventDispatcher.addEvent(dragonBones.EventObject.FRAME_EVENT,this._frameEventHandler,this),this._weaponR.eventDispatcher.addEvent(dragonBones.EventObject.FRAME_EVENT,this._frameEventHandler,this),t.instance.addChild(this._armatureDisplay),this._updateAnimation()}return e.prototype.move=function(e){this._moveDir!==e&&(this._moveDir=e,this._updateAnimation())},e.prototype.jump=function(){this._isJumpingA||(this._isJumpingA=!0,this._armature.animation.fadeIn("jump_1",-1,-1,0,e.NORMAL_ANIMATION_GROUP).resetToPose=!1,this._walkState=null)},e.prototype.squat=function(e){this._isSquating!==e&&(this._isSquating=e,this._updateAnimation())},e.prototype.attack=function(e){this._isAttackingA!==e&&(this._isAttackingA=e)},e.prototype.switchWeaponL=function(){this._weaponL.eventDispatcher.removeEvent(dragonBones.EventObject.FRAME_EVENT,this._frameEventHandler,this),this._weaponLIndex++,this._weaponLIndex%=e.WEAPON_L_LIST.length;var t=e.WEAPON_L_LIST[this._weaponLIndex];this._weaponL=dragonBones.EgretFactory.factory.buildArmature(t),this._armature.getSlot("weapon_l").childArmature=this._weaponL,this._weaponL.eventDispatcher.addEvent(dragonBones.EventObject.FRAME_EVENT,this._frameEventHandler,this)},e.prototype.switchWeaponR=function(){this._weaponR.eventDispatcher.removeEvent(dragonBones.EventObject.FRAME_EVENT,this._frameEventHandler,this),this._weaponRIndex++,this._weaponRIndex%=e.WEAPON_R_LIST.length;var t=e.WEAPON_R_LIST[this._weaponRIndex];this._weaponR=dragonBones.EgretFactory.factory.buildArmature(t),this._armature.getSlot("weapon_r").childArmature=this._weaponR,this._weaponR.eventDispatcher.addEvent(dragonBones.EventObject.FRAME_EVENT,this._frameEventHandler,this)},e.prototype.switchSkin=function(){this._skinIndex++,this._skinIndex%=e.SKINS.length;var t=e.SKINS[this._skinIndex],a=dragonBones.EgretFactory.factory.getArmatureData(t).defaultSkin;dragonBones.EgretFactory.factory.changeSkin(this._armature,a,["weapon_l","weapon_r"])},e.prototype.aim=function(e,t){this._target.x=e,this._target.y=t},e.prototype.update=function(){this._updatePosition(),this._updateAim(),this._updateAttack()},e.prototype._animationEventHandler=function(t){switch(t.type){case dragonBones.EventObject.FADE_IN_COMPLETE:"jump_1"===t.eventObject.animationState.name&&(this._isJumpingB=!0,this._speedY=-e.JUMP_SPEED,0!==this._moveDir&&(this._moveDir*this._faceDir>0?this._speedX=e.MAX_MOVE_SPEED_FRONT*this._faceDir:this._speedX=-e.MAX_MOVE_SPEED_BACK*this._faceDir),this._armature.animation.fadeIn("jump_2",-1,-1,0,e.NORMAL_ANIMATION_GROUP).resetToPose=!1);break;case dragonBones.EventObject.FADE_OUT_COMPLETE:"attack_01"===t.eventObject.animationState.name&&(this._isAttackingB=!1,this._attackState=null);break;case dragonBones.EventObject.COMPLETE:"jump_4"===t.eventObject.animationState.name&&(this._isJumpingA=!1,this._isJumpingB=!1,this._updateAnimation())}},e.prototype._frameEventHandler=function(e){"fire"===e.eventObject.name&&(e.eventObject.armature.display.localToGlobal(e.eventObject.bone.global.x,e.eventObject.bone.global.y,this._helpPoint),this._fire(this._helpPoint))},e.prototype._fire=function(e){var a=this._faceDir<0?Math.PI-this._aimRadian:this._aimRadian,i=new s("bullet_01","fire_effect_01",a+.02*Math.random()-.01,40,e);t.instance.addBullet(i)},e.prototype._updateAnimation=function(){return this._isJumpingA?void 0:this._isSquating?(this._speedX=0,this._armature.animation.fadeIn("squat",-1,-1,0,e.NORMAL_ANIMATION_GROUP).resetToPose=!1,void(this._walkState=null)):void(0===this._moveDir?(this._speedX=0,this._armature.animation.fadeIn("idle",-1,-1,0,e.NORMAL_ANIMATION_GROUP).resetToPose=!1,this._walkState=null):(null===this._walkState&&(this._walkState=this._armature.animation.fadeIn("walk",-1,-1,0,e.NORMAL_ANIMATION_GROUP),this._walkState.resetToPose=!1),this._moveDir*this._faceDir>0?this._walkState.timeScale=e.MAX_MOVE_SPEED_FRONT/e.NORMALIZE_MOVE_SPEED:this._walkState.timeScale=-e.MAX_MOVE_SPEED_BACK/e.NORMALIZE_MOVE_SPEED,this._moveDir*this._faceDir>0?this._speedX=e.MAX_MOVE_SPEED_FRONT*this._faceDir:this._speedX=-e.MAX_MOVE_SPEED_BACK*this._faceDir))},e.prototype._updatePosition=function(){0!==this._speedX&&(this._armatureDisplay.x+=this._speedX,this._armatureDisplay.x<0?this._armatureDisplay.x=0:this._armatureDisplay.x>t.STAGE_WIDTH&&(this._armatureDisplay.x=t.STAGE_WIDTH)),0!==this._speedY&&(this._speedY<5&&this._speedY+t.G>=5&&(this._armature.animation.fadeIn("jump_3",-1,-1,0,e.NORMAL_ANIMATION_GROUP).resetToPose=!1),this._speedY+=t.G,this._armatureDisplay.y+=this._speedY,this._armatureDisplay.y>t.GROUND&&(this._armatureDisplay.y=t.GROUND,this._speedY=0,this._armature.animation.fadeIn("jump_4",-1,-1,0,e.NORMAL_ANIMATION_GROUP).resetToPose=!1))},e.prototype._updateAim=function(){this._faceDir=this._target.x>this._armatureDisplay.x?1:-1,this._armatureDisplay.armature.flipX!==this._faceDir<0&&(this._armatureDisplay.armature.flipX=!this._armatureDisplay.armature.flipX,0!==this._moveDir&&this._updateAnimation());var t=this._armature.getBone("chest").global.y*this._armatureDisplay.scaleY;this._faceDir>0?this._aimRadian=Math.atan2(this._target.y-this._armatureDisplay.y-t,this._target.x-this._armatureDisplay.x):(this._aimRadian=Math.PI-Math.atan2(this._target.y-this._armatureDisplay.y-t,this._target.x-this._armatureDisplay.x),this._aimRadian>Math.PI&&(this._aimRadian-=2*Math.PI));var a=0;a=this._aimRadian>0?-1:1,(null===this._aimState||this._aimDir!==a)&&(this._aimDir=a,this._aimDir>=0?this._aimState=this._armature.animation.fadeIn("aim_up",-1,-1,0,e.AIM_ANIMATION_GROUP):this._aimState=this._armature.animation.fadeIn("aim_down",-1,-1,0,e.AIM_ANIMATION_GROUP),this._aimState.resetToPose=!1),this._aimState.weight=Math.abs(this._aimRadian/Math.PI*2),this._armature.invalidUpdate()},e.prototype._updateAttack=function(){this._isAttackingA&&!this._isAttackingB&&(this._isAttackingB=!0,this._attackState=this._armature.animation.fadeIn("attack_01",-1,-1,0,e.ATTACK_ANIMATION_GROUP),this._attackState.resetToPose=!1,this._attackState.autoFadeOutTime=this._attackState.fadeTotalTime)},e}();a.JUMP_SPEED=20,a.NORMALIZE_MOVE_SPEED=3.6,a.MAX_MOVE_SPEED_FRONT=1.4*a.NORMALIZE_MOVE_SPEED,a.MAX_MOVE_SPEED_BACK=1*a.NORMALIZE_MOVE_SPEED,a.NORMAL_ANIMATION_GROUP="normal",a.AIM_ANIMATION_GROUP="aim",a.ATTACK_ANIMATION_GROUP="attack",a.WEAPON_L_LIST=["weapon_1502b_l","weapon_1005","weapon_1005b","weapon_1005c","weapon_1005d","weapon_1005e"],a.WEAPON_R_LIST=["weapon_1502b_r","weapon_1005","weapon_1005b","weapon_1005c","weapon_1005d"],a.SKINS=["mecha_1502b","skin_a","skin_b","skin_c"],__reflect(a.prototype,"Mecha");var s=function(){function e(e,a,s,i,r){this._speedX=0,this._speedY=0,this._effecDisplay=null,this._speedX=Math.cos(s)*i,this._speedY=Math.sin(s)*i,this._armatureDisplay=dragonBones.EgretFactory.factory.buildArmatureDisplay(e),this._armatureDisplay.x=r.x+2*Math.random()-1,this._armatureDisplay.y=r.y+2*Math.random()-1,this._armatureDisplay.rotation=180*s/Math.PI,null!==a&&(this._effecDisplay=dragonBones.EgretFactory.factory.buildArmatureDisplay(a),this._effecDisplay.rotation=180*s/Math.PI,this._effecDisplay.x=this._armatureDisplay.x,this._effecDisplay.y=this._armatureDisplay.y,this._effecDisplay.scaleX=1+1*Math.random(),this._effecDisplay.scaleY=1+.5*Math.random(),Math.random()<.5&&(this._effecDisplay.scaleY*=-1),t.instance.addChild(this._effecDisplay),this._effecDisplay.animation.play("idle")),t.instance.addChild(this._armatureDisplay),this._armatureDisplay.animation.play("idle")}return e.prototype.update=function(){return this._armatureDisplay.x+=this._speedX,this._armatureDisplay.y+=this._speedY,this._armatureDisplay.x<-100||this._armatureDisplay.x>=t.STAGE_WIDTH+100||this._armatureDisplay.y<-100||this._armatureDisplay.y>=t.STAGE_HEIGHT+100?(t.instance.removeChild(this._armatureDisplay),this._armatureDisplay.dispose(),null!==this._effecDisplay&&(t.instance.removeChild(this._effecDisplay),this._effecDisplay.dispose()),!0):!1},e}();__reflect(s.prototype,"Bullet")}(coreElement||(coreElement={}));var HelloDragonBones=function(e){function t(){var t=e.call(this)||this;return t._resources.push("resource/assets/dragon_boy_ske.dbbin","resource/assets/dragon_boy_tex.json","resource/assets/dragon_boy_tex.png"),t}return __extends(t,e),t.prototype._onStart=function(){var e=dragonBones.EgretFactory.factory;e.parseDragonBonesData(RES.getRes("resource/assets/dragon_boy_ske.dbbin")),e.parseTextureAtlasData(RES.getRes("resource/assets/dragon_boy_tex.json"),RES.getRes("resource/assets/dragon_boy_tex.png"));var t=e.buildArmatureDisplay("DragonBoy");t.animation.play("walk"),t.x=.5*this.stage.stageWidth,t.y=.5*this.stage.stageHeight+100,this.addChild(t)},t}(BaseTest);__reflect(HelloDragonBones.prototype,"HelloDragonBones");var PerformanceTest=function(e){function t(){var t=e.call(this)||this;return t._addingArmature=!1,t._removingArmature=!1,t._text=new egret.TextField,t._armatures=[],t._resources.push("resource/assets/dragon_boy_ske.dbbin","resource/assets/dragon_boy_tex.json","resource/assets/dragon_boy_tex.png"),t}return __extends(t,e),t.prototype._onStart=function(){this._text.size=20,this._text.textAlign=egret.HorizontalAlign.CENTER,this._text.text="",this.addChild(this._text);for(var e=0;300>e;++e)this._addArmature();this._resetPosition(),this._updateText(),this.stage.addEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this._touchHandler,this)},t.prototype._enterFrameHandler=function(e){if(this._addingArmature){for(var t=0;10>t;++t)this._addArmature();this._resetPosition(),this._updateText()}if(this._removingArmature){for(var t=0;10>t;++t)this._removeArmature();this._resetPosition(),this._updateText()}},t.prototype._touchHandler=function(e){switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:var t=e.stageX>.5*this.stage.stageWidth;this._addingArmature=t,this._removingArmature=!t;break;case egret.TouchEvent.TOUCH_END:this._addingArmature=!1,this._removingArmature=!1}},t.prototype._addArmature=function(){0===this._armatures.length&&(dragonBones.EgretFactory.factory.parseDragonBonesData(RES.getRes("resource/assets/dragon_boy_ske.dbbin")),dragonBones.EgretFactory.factory.parseTextureAtlasData(RES.getRes("resource/assets/dragon_boy_tex.json"),RES.getRes("resource/assets/dragon_boy_tex.png")));var e=dragonBones.EgretFactory.factory.buildArmatureDisplay("DragonBoy");e.armature.cacheFrameRate=24,e.animation.play("walk",0),e.scaleX=e.scaleY=.7,this.addChild(e),this._armatures.push(e)},t.prototype._removeArmature=function(){if(0!==this._armatures.length){var e=this._armatures.pop();this.removeChild(e),e.dispose(),0===this._armatures.length&&(dragonBones.EgretFactory.factory.clear(!0),dragonBones.BaseObject.clearPool())}},t.prototype._resetPosition=function(){var e=this._armatures.length;if(0!==e)for(var t=50,a=150,s=100,i=this.stage.stageWidth-2*t,r=Math.floor(i/s),n=.5*(this.stage.stageWidth-r*s),o=i/r,_=(this.stage.stageHeight-2*a)/Math.ceil(e/r),h=0,l=e;l>h;++h){var p=this._armatures[h],c=Math.floor(h/r);p.x=h%r*o+n,p.y=c*_+a}},t.prototype._updateText=function(){this._text.text="Count: "+this._armatures.length+" \nTouch screen left to decrease count / right to increase count.",this._text.width=this.stage.stageWidth,this._text.x=0,this._text.y=this.stage.stageHeight-60,this.addChild(this._text)},t}(BaseTest);__reflect(PerformanceTest.prototype,"PerformanceTest");var ReplaceSlotDisplay=function(e){function t(){var t=e.call(this)||this;return t._displayIndex=0,t._replaceDisplays=["display0002","display0003","display0004","display0005","display0006","display0007","display0008","display0009","display0010","meshA","meshB","meshC"],t._factory=dragonBones.EgretFactory.factory,t._resources.push("resource/assets/replace_slot_display/main_ske.json","resource/assets/replace_slot_display/main_tex.json","resource/assets/replace_slot_display/main_tex.png","resource/assets/replace_slot_display/replace_ske.json","resource/assets/replace_slot_display/replace_tex.json","resource/assets/replace_slot_display/replace_tex.png"),t}return __extends(t,e),t.prototype._onStart=function(){var e=this;this._factory.parseDragonBonesData(RES.getRes("resource/assets/replace_slot_display/main_ske.json")),this._factory.parseTextureAtlasData(RES.getRes("resource/assets/replace_slot_display/main_tex.json"),RES.getRes("resource/assets/replace_slot_display/main_tex.png")),this._factory.parseDragonBonesData(RES.getRes("resource/assets/replace_slot_display/replace_ske.json")),this._factory.parseTextureAtlasData(RES.getRes("resource/assets/replace_slot_display/replace_tex.json"),RES.getRes("resource/assets/replace_slot_display/replace_tex.png")),this._armatureDisplay=this._factory.buildArmatureDisplay("MyArmature"),this._armatureDisplay.animation.timeScale=.1,this._armatureDisplay.animation.play(),this._armatureDisplay.x=.5*this.stage.stageWidth,this._armatureDisplay.y=.5*this.stage.stageHeight,this.addChild(this._armatureDisplay),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._replaceDisplay()},this)},t.prototype._replaceDisplay=function(){this._displayIndex=(this._displayIndex+1)%this._replaceDisplays.length;var e=this._replaceDisplays[this._displayIndex];if(e.indexOf("mesh")>=0)switch(e){case"meshA":this._factory.replaceSlotDisplay("replace","MyMesh","meshA","weapon_1004_1",this._armatureDisplay.armature.getSlot("weapon")),this._factory.replaceSlotDisplay("replace","MyDisplay","ball","display0002",this._armatureDisplay.armature.getSlot("mesh"));break;case"meshB":this._factory.replaceSlotDisplay("replace","MyMesh","meshB","weapon_1004_1",this._armatureDisplay.armature.getSlot("weapon")),this._factory.replaceSlotDisplay("replace","MyDisplay","ball","display0003",this._armatureDisplay.armature.getSlot("mesh"));break;case"meshC":this._factory.replaceSlotDisplay("replace","MyMesh","mesh","weapon_1004_1",this._armatureDisplay.armature.getSlot("weapon")),this._factory.replaceSlotDisplay("replace","MyDisplay","ball","display0005",this._armatureDisplay.armature.getSlot("mesh"))}else this._factory.replaceSlotDisplay("replace","MyDisplay","ball",e,this._armatureDisplay.armature.getSlot("ball"))},t}(BaseTest);__reflect(ReplaceSlotDisplay.prototype,"ReplaceSlotDisplay");var Main=function(e){function t(){var t=e.call(this)||this;return t.addChild(new AnimationCopyTest),t}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");