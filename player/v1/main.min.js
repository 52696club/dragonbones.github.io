var __reflect=this&&this.__reflect||function(t,e,a){t.__class__=e,a?a.push(e):a=[e],t.__types__=t.__types__?a.concat(t.__types__):a},__extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)},DragManager=function(){function t(){this.dragTarget=null,this._isDragMove=!1,this._helpPoint=new egret.Point,this._dragPosition=new egret.Point,this._dragOffset=new egret.Point,this._dragSpeed=new egret.Point}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.enableDrag=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._dragHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._dragHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this._dragHandler,this))},t.prototype.disableDrag=function(t){t&&(t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this._dragHandler,this),t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._dragHandler,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this._dragHandler,this),t.removeEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this))},t.prototype._dragHandler=function(e){switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:if(this.dragTarget)return;this.dragTarget=e.currentTarget,this.dragTarget.parent.globalToLocal(e.stageX,e.stageY,this._helpPoint),this._dragPosition.x=this.dragTarget.x,this._dragPosition.y=this.dragTarget.y,this._dragOffset.x=this._dragPosition.x-this._helpPoint.x,this._dragOffset.y=this._dragPosition.y-this._helpPoint.y,this._dragSpeed.x=0,this._dragSpeed.y=0,this.dragTarget.addEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this),this.dragTarget.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._dragHandler,this);break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:case egret.TouchEvent.TOUCH_END:this.dragTarget&&(this.dragTarget.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this._dragHandler,this),this._isDragMove?this.dragTarget.dragSpeed=this._dragSpeed.clone():this.dragTarget.removeEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this),this.dragTarget.dispatchEventWith(t.DRAG_END),this.dragTarget=null),this._isDragMove=!1;break;case egret.TouchEvent.TOUCH_MOVE:this.dragTarget&&(this._isDragMove||(this._isDragMove=!0,this.dragTarget.dispatchEventWith(t.DRAG_BEGIN)),this.dragTarget.parent.globalToLocal(e.stageX,e.stageY,this._helpPoint),this._dragPosition.x=this._helpPoint.x+this._dragOffset.x,this._dragPosition.y=this._helpPoint.y+this._dragOffset.y)}},t.prototype._enterFrameHandler=function(e){var a=e.currentTarget;if(a===this.dragTarget)this._dragSpeed.x+=.5*(this._dragPosition.x-a.x-this._dragSpeed.x),this._dragSpeed.y+=.5*(this._dragPosition.y-a.y-this._dragSpeed.y),(a.x!==this._dragPosition.x||a.y!==this._dragPosition.y)&&(a.x=this._dragPosition.x,a.y=this._dragPosition.y,a.hasEventListener(t.DRAG_MOVE)&&a.dispatchEventWith(t.DRAG_MOVE));else{var n=a.dragSpeed;a.x+=n.x,a.y+=n.y,n.x*=.7,n.y*=.7,a.hasEventListener(t.DRAG_MOVE)&&a.dispatchEventWith(t.DRAG_MOVE),Math.abs(n.x)<1&&Math.abs(n.y)<1&&a.removeEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this)}},t}();DragManager.DRAG_BEGIN="dragBegin",DragManager.DRAG_END="dragEnd",DragManager.DRAG_MOVE="dragMove",DragManager._instance=null,__reflect(DragManager.prototype,"DragManager");var lang;!function(t){function e(e){e=e.replace("-","_"),t.language=n[e]}function a(e){return e[t.language]}var n;!function(t){t[t.en_US=0]="en_US",t[t.zh_CN=1]="zh_CN",t[t.ru_RF=2]="ru_RF"}(n=t.Language||(t.Language={})),t.language=n.en_US,t.setLanguageByString=e,t.get=a,t.Label={help:["Operation hint: <br> hold down the left mouse button to drag <br> the left mouse button click on the frame switch animated <br> sliding mouse wheel zooming scenes <br> left mouse button double click Reset zooming","操作提示：<br>按住鼠标左键可以拖拽场景<br>鼠标左键单击骨架切换动画<br>推拉鼠标滚轮缩放场景<br>鼠标左键双击场景重置缩放","Операции Подсказка: <br>, удерживая левую кнопку мыши перетащите <br>левой кнопкой мыши на раме выключателя анимированные <br>раздвижные мыши колесо масштабирование сцены <br>левой кнопкой мыши дважды щелкните Сбросить масштабирование"],qrcode:["扫描二维码，在手机端查看","扫描二维码，在手机端查看","扫描二维码，在手机端查看"]}}(lang||(lang={}));var Main=function(t){function e(){var a=t.call(this)||this;return a.context=new egret.EventDispatcher,a.model=new DragonBonesModel,a.view=new DragonBonesView,a.domView=new DomView,e._instance=a,a.addChild(a.view),a.addEventListener(egret.Event.ADDED_TO_STAGE,a._addToStageHandler,a),a}return __extends(e,t),e.getInstance=function(){return e._instance},e.prototype._addToStageHandler=function(t){this.init()},e.prototype.init=function(){this.model.init(),this.view.init(),this.domView.init(),e.getInstance().context.addEventListener(ModelEvent[ModelEvent.DragonBonesChange],this._modelEventHandler,this),console.assert(null!=document);var t=document.getElementById(e.DATA);t&&(this.model.inputData=JSON.parse(t.innerHTML))},e.prototype._modelEventHandler=function(t){switch(t.type){case ModelEvent[ModelEvent.DragonBonesChange]:this.model.inputData&&this.model.dragonBonesData&&(this.model.inputData.armature?this.model.armature=this.model.addArmature(this.model.inputData.armature):this.model.armature=this.model.addArmature(this.model.dragonBonesData.armatureNames[0]),this.model.armature&&(this.model.inputData.animation?this.model.armature.animation.play(this.model.inputData.animation):this.model.armature.animation.play()))}},e}(egret.DisplayObjectContainer);Main.DATA="data",Main._instance=null,__reflect(Main.prototype,"Main");var DomView=function(){function t(){this._model=null,this._armatureNameLabel=null,this._animationNameLabel=null,this._prevArmatureButton=null,this._nextArmatureButton=null,this._prevAnimationButton=null,this._nextAnimationButton=null,this._playAnimationButton=null,this._stopAnimationButton=null}return t.prototype._modelEventHandler=function(t){switch(t.type){case ModelEvent[ModelEvent.DragonBonesChange]:this._model.dragonBonesData&&(document.title=this._model.dragonBonesData.name,this._model.dragonBonesData.armatureNames.length>1?(this._prevArmatureButton.style.display="block",this._nextArmatureButton.style.display="block"):(this._prevArmatureButton.style.display="none",this._nextArmatureButton.style.display="none"));break;case ModelEvent[ModelEvent.ArmatureChange]:var e=t.data;this._armatureNameLabel.innerHTML=e?e.name:"",e&&(e.animation.animationNames.length>1?(this._prevAnimationButton.style.display="inline",this._nextAnimationButton.style.display="inline"):(this._prevAnimationButton.style.display="none",this._nextAnimationButton.style.display="none"));break;case ModelEvent[ModelEvent.AnimationChange]:var a=t.data;this._animationNameLabel.innerHTML=a?a.name:"";break;case ModelEvent[ModelEvent.AnimationStart]:case ModelEvent[ModelEvent.AnimationComplete]:case ModelEvent[ModelEvent.AnimationPlay]:case ModelEvent[ModelEvent.AnimationStop]:this._updatePlayAndStopButton()}},t.prototype._updatePlayAndStopButton=function(){this._model.armature&&this._model.armature.animation.isPlaying?(this._playAnimationButton.style.display="none",this._stopAnimationButton.style.display="block"):(this._playAnimationButton.style.display="block",this._stopAnimationButton.style.display="none")},t.prototype.init=function(){var t=this;if(this._model=Main.getInstance().model,this._armatureNameLabel=document.getElementById("armatureNameLabel"),this._animationNameLabel=document.getElementById("animationNameLabel"),this._prevArmatureButton=document.getElementById("prevArmatureButton"),this._nextArmatureButton=document.getElementById("nextArmatureButton"),this._prevAnimationButton=document.getElementById("prevAnimationButton"),this._nextAnimationButton=document.getElementById("nextAnimationButton"),this._playAnimationButton=document.getElementById("playAnimationButton"),this._stopAnimationButton=document.getElementById("stopAnimationButton"),this._prevArmatureButton.style.display="none",this._nextArmatureButton.style.display="none",this._prevArmatureButton.style.display="none",this._nextArmatureButton.style.display="none",this._prevAnimationButton.style.display="none",this._nextAnimationButton.style.display="none",this._playAnimationButton.style.display="none",this._stopAnimationButton.style.display="none",lang.setLanguageByString(navigator.language),document.getElementById("helpLabel").innerHTML=lang.get(lang.Label.help),document.getElementById("qrcodeLabel").innerHTML=lang.get(lang.Label.qrcode),egret.Capabilities.isMobile)document.getElementById("logo").style.display="none",document.getElementById("helpLabel").style.display="none",document.getElementById("qrcodeGroup").style.display="none";else{0===window.location.protocol.indexOf("http")?new QRCode(document.getElementById("qrcode"),{width:96,height:96}).makeCode(window.location.href):document.getElementById("qrcodeGroup").style.display="none";var e=document.body;e.ondragenter=e.ondragover=function(t){t.stopPropagation(),t.preventDefault()},e.ondrop=function(e){e.stopPropagation(),e.preventDefault();var a=e.dataTransfer;a&&a.files&&t._loadFiles(a.files)}}this._prevArmatureButton.onclick=function(){t._model.prevArmature()},this._nextArmatureButton.onclick=function(){t._model.nextArmature()},this._prevAnimationButton.onclick=function(){t._model.prevAnimation()},this._nextAnimationButton.onclick=function(){t._model.nextAnimation()},this._playAnimationButton.onclick=function(){t._model.playAnimation()},this._stopAnimationButton.onclick=function(){t._model.stopAnimation()},Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.DragonBonesChange],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.ArmatureChange],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.AnimationChange],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.AnimationStart],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.AnimationComplete],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.AnimationPlay],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.AnimationStop],this._modelEventHandler,this)},t.prototype._loadFiles=function(t){for(var e=this,a=[],n=(function(n){var i=n.target,r=i.file;if("image/png"===r.type?a.push(i):a.unshift(i),a.length===t.length){var o={textureAtlases:[],textures:[]},s=0;a.forEach(function(t){var e=t.file;if("image/png"===e.type){var a=document.createElement("img");a.id="textureAtlas_"+ ++s,a.src=t.result;var n=document.getElementById("hide"),i=document.getElementById(a.id);i&&(i.id="",i.src="",n.removeChild(i)),n.appendChild(a)}else try{var r=JSON.parse(t.result);"armature"in r?o.data||(o.data=r):(o.textureAtlases.push(r),o.textures.push("textureAtlas_"+(o.textures.length+1)))}catch(h){}}),e._model.inputData=o}}),i=0,r=t.length;r>i;++i){var o=t[i];if("image/png"===o.type){var s=new FileReader;s.file=o,s.onload=n,s.readAsDataURL(o)}else if(o.name.indexOf(".json")>0){var s=new FileReader;s.file=o,s.onload=n,s.readAsBinaryString(o)}}},t}();__reflect(DomView.prototype,"DomView");var ModelEvent;!function(t){t[t.DragonBonesChange=0]="DragonBonesChange",t[t.ArmatureAdd=1]="ArmatureAdd",t[t.ArmatureRemove=2]="ArmatureRemove",t[t.ArmatureChange=3]="ArmatureChange",t[t.AnimationStart=4]="AnimationStart",t[t.AnimationComplete=5]="AnimationComplete",t[t.AnimationPlay=6]="AnimationPlay",t[t.AnimationStop=7]="AnimationStop",t[t.AnimationChange=8]="AnimationChange"}(ModelEvent||(ModelEvent={}));var DragonBonesModel=function(){function t(){this._armatures=[],this._inputData=null,this._dragonBonesData=null,this._armature=null,this._animation=null}return t.prototype._animationHandler=function(t){switch(t.type){case dragonBones.EventObject.START:this._animation&&this._animation.name===t.animationState.name||(this._animation=t.animationState,Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.AnimationChange],!1,this._animation)),Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.AnimationStart],!1,this._animation);break;case dragonBones.EventObject.COMPLETE:Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.AnimationComplete],!1,this._animation)}},t.prototype.init=function(){},t.prototype.addArmature=function(t){if(!t)return null;var e=dragonBones.EgretFactory.factory.buildArmatureDisplay(t);return console.assert(null!=e),this._armatures.push(e.armature),Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.ArmatureAdd],!1,e.armature),e.armature},t.prototype.removeArmature=function(t){var e=this._armatures.indexOf(t);console.assert(e>=0),this.armature=null,this._armatures.splice(e,1),Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.ArmatureRemove],!1,t),t.dispose()},t.prototype.clearAllArmature=function(){for(var t=this._armatures.length;t--;){var e=this._armatures[t];this.removeArmature(e)}},t.prototype.changeArmature=function(t){if(this._armature){var e=this._dragonBonesData.armatureNames;t%=e.length,0>t&&(t=e.length+t),this.removeArmature(this._armature),this.armature=this.addArmature(e[t]),this.armature.animation.play()}},t.prototype.prevArmature=function(){this._armature?this.changeArmature(this._dragonBonesData.armatureNames.indexOf(this._armature.name)-1):this.changeArmature(0)},t.prototype.nextArmature=function(){this._armature?this.changeArmature(this._dragonBonesData.armatureNames.indexOf(this._armature.name)+1):this.changeArmature(0)},t.prototype.changeAnimation=function(t){if(this._armature){var e=this._armature.armatureData.animationNames;t%=e.length,0>t&&(t=e.length+t),this._armature.animation.play(e[t])}},t.prototype.prevAnimation=function(){if(this._armature)if(this._animation){var t=this._armature.armatureData.animationNames;this.changeAnimation(t.indexOf(this._animation.name)-1)}else this._armature.animation.play()},t.prototype.nextAnimation=function(){if(this._armature)if(this._animation){var t=this._armature.armatureData.animationNames;this.changeAnimation(t.indexOf(this._animation.name)+1)}else this._armature.animation.play()},t.prototype.playAnimation=function(){this._armature&&(this._armature.animation.play(),Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.AnimationPlay],!1))},t.prototype.stopAnimation=function(){this._armature&&(this._armature.animation.stop(),Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.AnimationStop],!1))},Object.defineProperty(t.prototype,"inputData",{get:function(){return this._inputData},set:function(t){if(this._inputData!==t){if(this.clearAllArmature(),this._inputData=t,this._inputData){console.assert(null!=this._inputData.data),console.assert(null!=this._inputData.textureAtlases),console.assert(null!=this._inputData.textures);var e=[];this._inputData.textures.forEach(function(t){if(t instanceof egret.Texture)e.push(t);else{var a=new egret.Texture,n=document.getElementById(t);console.assert(null!=n),a.bitmapData=new egret.BitmapData(n),e.push(a)}}),dragonBones.EgretFactory.factory.clear(!0),this._dragonBonesData=dragonBones.EgretFactory.factory.parseDragonBonesData(this._inputData.data),this._inputData.textureAtlases.forEach(function(t,a){dragonBones.EgretFactory.factory.parseTextureAtlasData(t,e[a])})}Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.DragonBonesChange],!1,this._inputData)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dragonBonesData",{get:function(){return this._dragonBonesData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"armatures",{get:function(){return this._armatures},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"armature",{get:function(){return this._armature},set:function(t){this._armature!==t&&(this._animation=null,Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.AnimationChange],!1,null),this._armature&&(this._armature.removeEventListener(dragonBones.EventObject.START,this._animationHandler,this),this._armature.removeEventListener(dragonBones.EventObject.COMPLETE,this._animationHandler,this)),this._armature=t,this._armature&&(this._armature.addEventListener(dragonBones.EventObject.START,this._animationHandler,this),this._armature.addEventListener(dragonBones.EventObject.COMPLETE,this._animationHandler,this)),Main.getInstance().context.dispatchEventWith(ModelEvent[ModelEvent.ArmatureChange],!1,this._armature))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),t}();__reflect(DragonBonesModel.prototype,"DragonBonesModel");var DragonBonesView=function(t){function e(){var e=t.call(this)||this;return e._isDraged=!1,e._scaleType=3,e._stageWidth=0,e._stageHeight=0,e._stageScale=1,e._backgroundScale=4,e._time=0,e._stageScalePoint=new egret.Point,e._viewStage=new egret.DisplayObjectContainer,e._armatureContainer=new egret.DisplayObjectContainer,e._lineH=new egret.Shape,e._lineV=new egret.Shape,e._background=new egret.Bitmap,e._viewStage.addChild(e._background),e._viewStage.addChild(e._lineV),e._viewStage.addChild(e._lineH),e._viewStage.addChild(e._armatureContainer),e._lineH.graphics.lineStyle(1,0,.7,!0),e._lineV.graphics.lineStyle(1,0,.7,!0),e._lineH.graphics.moveTo(0,0),e._lineV.graphics.moveTo(0,0),e._lineH.graphics.lineTo(2048,0),e._lineV.graphics.lineTo(0,2048),e._background.smoothing=!1,e._background.alpha=.5,e._background.scaleX=e._background.scaleY=e._backgroundScale,e._background.fillMode=egret.BitmapFillMode.REPEAT,e._background.bitmapData=new egret.BitmapData(document.getElementById("background")),e.addChild(e._viewStage),e}return __extends(e,t),e.prototype._resizeHandler=function(t){var e=Math.max(this._stageWidth,1),a=Math.max(this._stageHeight,1);this._stageWidth=this.stage.stageWidth,this._stageHeight=this.stage.stageHeight,this._lineH.width=this._stageWidth,this._lineV.height=this._stageHeight;var n=this._background.bitmapData.width*this._background.scaleX,i=this._background.bitmapData.height*this._background.scaleY;this._background.width=(this._stageWidth+n)/this._background.scaleX,this._background.height=(this._stageHeight+i)/this._background.scaleY,this._viewStage.x=this._stageWidth*this._viewStage.x/e,this._viewStage.y=this._stageHeight*this._viewStage.y/a,this._updateBackground()},e.prototype._touchHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._isDraged=!1,egret.Tween.removeTweens(this);break;case egret.TouchEvent.TOUCH_END:var e=(new Date).getTime();if(e-this._time<300)this.scaleToType(this._scaleType+1);else if(!this._isDraged&&t.target instanceof dragonBones.EgretArmatureDisplay){var a=t.target.armature;Main.getInstance().model.armature=a,a&&Main.getInstance().model.nextAnimation()}this._time=e;break;case DragManager.DRAG_MOVE:this._isDraged=!0,this._updateBackground()}},e.prototype._modelEventHandler=function(t){switch(t.type){case ModelEvent[ModelEvent.ArmatureAdd]:var e=t.data;this._armatureContainer.addChild(e.display).touchEnabled=!0;break;case ModelEvent[ModelEvent.ArmatureChange]:this.scaleToType(1);break;case ModelEvent[ModelEvent.ArmatureRemove]:var e=t.data;this._armatureContainer.removeChild(e.display)}},e.prototype._updateBackground=function(){this._lineH.x=-this._viewStage.x,this._lineV.y=-this._viewStage.y;var t=this._background.bitmapData.width*this._background.scaleX,e=this._background.bitmapData.height*this._background.scaleY;this._background.x=-Math.ceil(this._viewStage.x/t)*t,this._background.y=-Math.ceil(this._viewStage.y/e)*e},e.prototype._getFormatScale=function(t){return t<e.MIN_SCALE?t=e.MIN_SCALE:t>e.MAX_SCALE&&(t=e.MAX_SCALE),t},e.prototype.init=function(){var t=this;this._resizeHandler(null),this.scaleToType(1,0),this._viewStage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHandler,this),this._viewStage.addEventListener(egret.TouchEvent.TOUCH_END,this._touchHandler,this),this._viewStage.addEventListener(DragManager.DRAG_MOVE,this._touchHandler,this),this.stage.addEventListener(egret.Event.RESIZE,this._resizeHandler,this),DragManager.getInstance().enableDrag(this._viewStage),document.addEventListener("mousewheel",function(e){if(e.wheelDelta>0){var a=t._getFormatScale(1.2*t.stageScale);t.stageScale!==a&&(t._stageScalePoint.x=e.x-t._viewStage.x,t._stageScalePoint.y=e.y-t._viewStage.y,t._stageScalePoint.x=t._viewStage.x+(t._stageScalePoint.x-t._stageScalePoint.x/t.stageScale*a),t._stageScalePoint.y=t._viewStage.y+(t._stageScalePoint.y-t._stageScalePoint.y/t.stageScale*a),t.scaleTo(a,t._stageScalePoint))}else{var a=t._getFormatScale(.8*t.stageScale);t.stageScale!==a&&(t._stageScalePoint.x=t._stageWidth-e.x,t._stageScalePoint.y=t._stageHeight-e.y,t._stageScalePoint.x=t._viewStage.x+.2*(t._stageScalePoint.x-t._viewStage.x),t._stageScalePoint.y=t._viewStage.y+.2*(t._stageScalePoint.y-t._viewStage.y),t.scaleTo(a,t._stageScalePoint))}}),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.ArmatureAdd],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.ArmatureChange],this._modelEventHandler,this),Main.getInstance().context.addEventListener(ModelEvent[ModelEvent.ArmatureRemove],this._modelEventHandler,this)},e.prototype.scaleTo=function(t,e,a){void 0===a&&(a=500),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this._viewStage),egret.Tween.get(this).to({stageScale:t},a,egret.Ease.cubicOut),e&&egret.Tween.get(this._viewStage,{onChange:this._updateBackground,onChangeObj:this}).to({x:e.x,y:e.y},a,egret.Ease.cubicOut)},e.prototype.scaleToType=function(t,e){void 0===e&&(e=500),this._scaleType=t,2===this._scaleType&&(this._scaleType=0);var a=1,n=Main.getInstance().model.armature;if(n){var i=n.display.getBounds(),r=this._stageWidth/this._stageHeight,o=i.width/i.height;switch(this._scaleType){case 0:break;case 1:a=r>o?this._stageHeight/(i.height+100):this._stageWidth/(i.width+100)}this._stageScalePoint.x=.5*this._stageWidth-(i.x+.5*i.width)*a,this._stageScalePoint.y=.5*this._stageHeight-(i.y+.5*i.height)*a}else this._stageScalePoint.x=.5*this._stageWidth,this._stageScalePoint.y=.5*this._stageHeight;this.scaleTo(a,this._stageScalePoint,e)},Object.defineProperty(e.prototype,"stageScale",{get:function(){return this._stageScale},set:function(t){t=this._getFormatScale(t),this._stageScale=t,this._armatureContainer.scaleX=this._armatureContainer.scaleY=this._stageScale,this._background.scaleX=this._background.scaleY=this._stageScale*this._backgroundScale;var e=this._background.bitmapData.width*this._background.scaleX,a=this._background.bitmapData.height*this._background.scaleY;this._background.width=(this._stageWidth+e)/this._background.scaleX,this._background.height=(this._stageHeight+a)/this._background.scaleY,this._updateBackground()},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);DragonBonesView.MAX_SCALE=25,DragonBonesView.MIN_SCALE=.1,__reflect(DragonBonesView.prototype,"DragonBonesView");