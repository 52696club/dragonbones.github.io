var __extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)},dragonBones;!function(t){var e=function(e){function a(){e.call(this),a._clock||(a._clock=new t.WorldClock,PIXI.ticker.shared.add(a._clockHandler,a))}return __extends(a,e),a._clockHandler=function(t){return a._clock.advanceTime(-1),!1},a.prototype._onClear=function(){this.advanceTimeBySelf(!1),this._armature=null},a.prototype._dispatchEvent=function(t){this.emit(t.type,t)},a.prototype.hasEvent=function(t){return this.listeners(t,!0)},a.prototype.addEvent=function(t,e,a){this.addListener(t,e,a)},a.prototype.removeEvent=function(t,e,a){this.removeListener(t,e,a)},a.prototype.advanceTimeBySelf=function(t){t?a._clock.add(this._armature):a._clock.remove(this._armature)},a.prototype.dispose=function(){this._armature&&this._armature.dispose()},Object.defineProperty(a.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),a._clock=null,a}(PIXI.Container);t.PixiArmatureDisplay=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),t.Armature._soundEventManager||(t.Armature._soundEventManager=new t.PixiArmatureDisplay)}return __extends(a,e),a.prototype._generateTextureAtlasData=function(e,a){return e?e.texture=a:e=t.BaseObject.borrowObject(t.PixiTextureAtlasData),e},a.prototype._generateArmature=function(e){var a=t.BaseObject.borrowObject(t.Armature),r=new t.PixiArmatureDisplay;return a._armatureData=e.armature,a._skinData=e.skin,a._animation=t.BaseObject.borrowObject(t.Animation),a._display=r,r._armature=a,a._animation._armature=a,a.animation.animations=e.armature.animations,a},a.prototype._generateSlot=function(e,a){var r=t.BaseObject.borrowObject(t.PixiSlot),i=a.slot,n=[];r.name=i.name,r._rawDisplay=new PIXI.Sprite;for(var s=0,o=a.displays.length;s<o;++s){var l=a.displays[s];switch(l.type){case 0:l.textureData||(l.textureData=this._getTextureData(e.dataName,l.name)),n.push(r._rawDisplay);break;case 2:l.textureData||(l.textureData=this._getTextureData(e.dataName,l.name)),r._meshDisplay||(r._meshDisplay=new PIXI.mesh.Mesh(null,null,null,null,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES)),n.push(r._meshDisplay);break;case 1:var u=this.buildArmature(l.name,e.dataName);u&&(i.actions.length>0?(u._action=i.actions[i.actions.length-1],u.advanceTime(0)):u.animation.play()),n.push(u);break;default:n.push(null)}}return r._setDisplayList(n),r},a.prototype.buildArmatureDisplay=function(t,e,a){void 0===e&&(e=null),void 0===a&&(a=null);var r=this.buildArmature(t,e,a),i=r?r._display:null;return i&&i.advanceTimeBySelf(!0),i},a.prototype.getTextureDisplay=function(t,e){void 0===e&&(e=null);var a=this._getTextureData(e,t);return a?new PIXI.Sprite(a.texture):null},Object.defineProperty(a.prototype,"soundEventManater",{get:function(){return t.Armature._soundEventManager},enumerable:!0,configurable:!0}),a}(t.BaseFactory);t.PixiFactory=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[Class dragonBones.PixiSlot]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._renderDisplay=null},e.prototype._onUpdateDisplay=function(){this._rawDisplay||(this._rawDisplay=new PIXI.Sprite),this._renderDisplay=this._display||this._rawDisplay},e.prototype._initDisplay=function(t){},e.prototype._addDisplay=function(){var t=this._armature._display;t.addChild(this._renderDisplay)},e.prototype._replaceDisplay=function(t){var e=this._armature._display,a=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,a),e.removeChild(a)},e.prototype._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},e.prototype._disposeDisplay=function(t){},e.prototype._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},e.prototype._updateBlendMode=function(){if(this._blendMode<e.BLEND_MODE_LIST.length){var t=e.BLEND_MODE_LIST[this._blendMode];t>0&&this._renderDisplay instanceof PIXI.Sprite&&(this._renderDisplay.blendMode=t)}},e.prototype._updateColor=function(){this._renderDisplay.alpha=this._colorTransform.alphaMultiplier},e.prototype._updateFilters=function(){},e.prototype._updateFrame=function(){var t=this._renderDisplay;if(this._display&&this._displayIndex>=0){var e=this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex]:null,a=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,r=a||e,i=r.textureData;if(i){if(!i.texture){var n=i.parent.texture;if(n){var s=new PIXI.Rectangle(0,0,i.region.width,i.region.height);i.texture=new PIXI.Texture(n,null,i.region,s,i.rotated)}}var o=this._armature._replacedTexture||i.texture;if(o){if(this._meshData&&this._display==this._meshDisplay){var l=this._meshDisplay;l.uvs=new Float32Array(this._meshData.uvs),l.vertices=new Float32Array(this._meshData.vertices),l.indices=new Uint16Array(this._meshData.vertexIndices);for(var u=0,p=l.uvs.length;u<p;u+=2){var h=l.uvs[u],_=l.uvs[u+1];l.uvs[u]=(i.region.x+h*i.region.width)/o.baseTexture.width,l.uvs[u+1]=(i.region.y+_*i.region.height)/o.baseTexture.height}l.texture=o,l.dirty=!0}else{var d=i.frame||i.region,c=d.width,y=d.height;i.rotated&&(c=d.height,y=d.width);var D=r.pivot.x,f=r.pivot.y;r.isRelativePivot&&(D=c*D,f=y*f),i.frame&&(D+=i.frame.x,f+=i.frame.y),e&&a&&(D+=e.transform.x-a.transform.x,f+=e.transform.y-a.transform.y),t.texture=o,t.pivot.set(D,f)}return void this._updateVisible()}}}t.visible=!1,t.texture=null,t.pivot.set(0,0),t.x=0,t.y=0},e.prototype._updateMesh=function(){var t=this._meshDisplay,e=this._ffdVertices.length>0;if(this._meshData.skinned)for(var a=0,r=0,i=this._meshData.vertices.length;a<i;a+=2){for(var n=a/2,s=this._meshData.boneIndices[n],o=this._meshData.boneVertices[n],l=this._meshData.weights[n],u=0,p=0,h=0,_=s.length;h<_;++h){var d=this._meshBones[s[h]],c=d.globalTransformMatrix,y=l[h],D=0,f=0;e?(D=o[2*h]+this._ffdVertices[r],f=o[2*h+1]+this._ffdVertices[r+1]):(D=o[2*h],f=o[2*h+1]),u+=(c.a*D+c.c*f+c.tx)*y,p+=(c.b*D+c.d*f+c.ty)*y,r+=2}t.vertices[a]=u,t.vertices[a+1]=p}else if(e)for(var m=this._meshData.vertices,a=0,i=this._meshData.vertices.length;a<i;a+=2){var u=m[a]+this._ffdVertices[a],p=m[a+1]+this._ffdVertices[a+1];t.vertices[a]=u,t.vertices[a+1]=p}},e.prototype._updateTransform=function(){this._renderDisplay.setTransform(this.global.x,this.global.y,this.global.scaleX,this.global.scaleY,this.global.skewY,0,0,this._renderDisplay.pivot.x,this._renderDisplay.pivot.y)},e.BLEND_MODE_LIST=[PIXI.BLEND_MODES.NORMAL,PIXI.BLEND_MODES.ADD,-1,PIXI.BLEND_MODES.DARKEN,PIXI.BLEND_MODES.DIFFERENCE,-1,PIXI.BLEND_MODES.HARD_LIGHT,-1,-1,PIXI.BLEND_MODES.LIGHTEN,PIXI.BLEND_MODES.MULTIPLY,PIXI.BLEND_MODES.OVERLAY,PIXI.BLEND_MODES.SCREEN,-1],e}(t.Slot);t.PixiSlot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function r(){e.call(this)}return __extends(r,e),r.toString=function(){return"[Class dragonBones.PixiTextureAtlasData]"},r.prototype._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture=null)},r.prototype.generateTextureData=function(){return t.BaseObject.borrowObject(a)},r}(t.TextureAtlasData);t.PixiTextureAtlasData=e;var a=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[Class dragonBones.PixiTextureData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture.destroy(!1),this.texture=null)},e}(t.TextureData);t.PixiTextureData=a}(dragonBones||(dragonBones={}));