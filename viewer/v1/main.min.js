"use strict";var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),common;!function(t){function e(t){var e=String(t),n=l[e];return n||(n=l[e]=h.create(t)),n}function n(t){var e=u[String(t)];if(e&&e.length>0){var n=e.pop();return n}var i=new t;return i._onClear(),i}function i(t){var e=String(t.constructor),n=e in c?r:c[e],i=u[e]=u[e]||[];i.length<n&&(console.assert(i.indexOf(t)<0),i.push(t))}function a(t,e){if((0>e||e!==e)&&(e=0),t){var n=String(t),i=u[n];c[n]=e,i&&i.length>e&&(i.length=e)}else{r=e;for(var n in u){var i=u[n];i.length>e&&(i.length=e),n in c&&(c[n]=e)}}}function o(t){if(t){var e=u[String(t)];e&&e.length&&(e.length=0)}else for(var n in u){var e=u[n];e.length=0}}var r=1e3,s=0,l={},c={},u={};t.getInstance=e,t.create=n,t.release=i,t.setMaxCount=a,t.clear=o;var h=function(){function t(){this.hashCode=s++}return t.toString=function(){throw new Error},t.getInstance=function(t){return e(t)},t.create=function(t){return n(t)},t.prototype.release=function(){this._onClear(),i(this)},t.prototype.dispose=function(){this._onClear()},t}();t.BaseObject=h,__reflect(h.prototype,"common.BaseObject")}(common||(common={}));var common;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="",e.data=null,e}return __extends(e,t),e.toString=function(){return"[class common.Event]"},e.prototype._onClear=function(){this.type="",this.data=null},e.prototype.toString=function(){return"[object Event Type "+this.type+" Data "+this.data+"]"},e.prototype.copyFrom=function(t){return this.type=t.type,this.target=t.target,this.currentTarget=t.currentTarget,this.data=t.data,this},e}(t.BaseObject);t.Event=e,__reflect(e.prototype,"common.Event");var n=function(t){function n(){var e=t.call(this)||this;return e.enabled=!0,e._dipatchLevel=0,e._listenerBins={},e}return __extends(n,t),n.toString=function(){return"[class common.EventDispatcher]"},n.prototype._onClear=function(){for(var t in this._listenerBins)delete this._listenerBins[t];this.enabled=!0,this._dipatchLevel=0},n.prototype._isSameListener=function(t,e){return t===e},n.prototype.hasEventListener=function(t){return t in this._listenerBins[t]},n.prototype.addEventListener=function(t,e,n,i,a){void 0===i&&(i=null),void 0===a&&(a=0),this.removeEventListener(t,e);var o=this._listenerBins[t];o?0!==this._dipatchLevel&&(this._listenerBins[t]=o=o.concat()):this._listenerBins[t]=o=[],o.push({listener:e,thisTarget:n,data:i,priority:a})},n.prototype.removeEventListener=function(t,e,n){void 0===n&&(n=null);var i=this._listenerBins[t];if(i){0!==this._dipatchLevel&&(this._listenerBins[t]=i=i.concat());for(var a=0,o=i.length;o>a;++a){var r=i[a];if(r.listener===e&&this._isSameListener(r.data,n)){i.splice(a,1);break}}}},n.prototype.removeAllEventListener=function(t){if(t)delete this._listenerBins[t];else for(var e in this._listenerBins)delete this._listenerBins[e]},n.prototype.dispatchEvent=function(t){var e=t.type,n=this._listenerBins[e];if(n){t.target=this,t.currentTarget||(t.currentTarget=t.target),this._dipatchLevel++;for(var i=0,a=n;i<a.length;i++){var o=a[i];o.listener.call(o.thisTarget,t,o.data)}this._dipatchLevel--}},n.prototype.dispatchEventWidth=function(t,n){if(this.enabled){var i=e.create(e);i.type=t,i.data=n,this.dispatchEvent(i),i.release()}},n}(t.BaseObject);t.EventDispatcher=n,__reflect(n.prototype,"common.EventDispatcher",["common.IEventDispatcher"])}(common||(common={}));var common;!function(t){function e(t){u.indexOf(t)<0&&u.push(t)}function n(t){var e=u.indexOf(t);e>=0&&u.splice(e,1)}var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class common.Notification]"},e.prototype._onClear=function(){this.type="",this.target=null,this.data=null},e}(t.BaseObject);t.Notification=i,__reflect(i.prototype,"common.Notification");var a=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.controller=t.controller,n}return __extends(n,e),n.prototype.sendNotification=function(e,n){t.context.sendNotification(e,n,this)},Object.defineProperty(n.prototype,"application",{get:function(){return t.context.application},enumerable:!0,configurable:!0}),n}(t.BaseObject);t.Model=a,__reflect(a.prototype,"common.Model");var o=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.controller=t.controller,n}return __extends(n,e),n.prototype._notificationListenerHandler=function(t,e){e.call(this,t.data)},n.prototype.addNotification=function(e,n){t.context.addEventListener(e,this._notificationListenerHandler,this,n)},n.prototype.removeNotification=function(e,n){t.context.removeEventListener(e,this._notificationListenerHandler,n)},n.prototype.sendNotification=function(e,n){t.context.sendNotification(e,n,this)},n.prototype.initialize=function(t,e,n){this.model=t,this.component=e,this._onInitialize(n),this.update()},Object.defineProperty(n.prototype,"application",{get:function(){return t.context.application},enumerable:!0,configurable:!0}),n}(t.EventDispatcher);t.View=o,__reflect(o.prototype,"common.View");var r=function(a){function o(){var e=null!==a&&a.apply(this,arguments)||this;return e.success=null,e.controller=t.controller,e.result=null,e._isRetained=!1,e._guard=null,e._hook=null,e._queue=null,e}return __extends(o,a),o.prototype._onClear=function(){this.success=null,this.result=null,this._isRetained=!1,this._guard=null,this._hook=null,this._queue=null},o.prototype._retain=function(){this._isRetained=!0,e(this)},o.prototype._release=function(t){this.success=t,null!==this._hook&&this._hook(this),null!==this._queue&&(this.success?this._queue._next(this.result):this._queue._fail(this.result)),this._isRetained=!1,n(this)},o.prototype.execute=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=null),t instanceof i?this.notification=t:(this.notification=i.create(i),this.notification.data=t),this._guard=e,this._hook=n,null===this._guard||this._guard(this)!==!1?(this._onExecute(),this.isRetained||null!==this.success||(this.success=!0),null===this._hook||this.isRetained||this._hook(this)):this.success=!0,this.result},o.prototype.sendNotification=function(e,n){t.context.sendNotification(e,n,null)},Object.defineProperty(o.prototype,"isRetained",{get:function(){return this._isRetained},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return this.notification.data},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"application",{get:function(){return t.context.application},enumerable:!0,configurable:!0}),o}(t.BaseObject);t.Command=r,__reflect(r.prototype,"common.Command");var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._commandBins=[],e}return __extends(e,t),e.prototype._executeSubCommand=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this._currentCommand=new t,this._currentCommand._queue=this,this._currentCommand.execute(e,n,i)},e.prototype._onExecute=function(){this._next(this.notification.data)},e.prototype._next=function(t){if(this._commandBins.length>0){var e=this._commandBins.shift();e&&(this.notification.data=t,this._executeSubCommand(e.commandClass,this.notification,e.guard,e.hook),this._currentCommand.isRetained||(this._currentCommand.success?this._next(this._currentCommand.result):this._fail(this._currentCommand.result)))}else this.result=this._currentCommand.result,this._release(!0)},e.prototype._fail=function(t){this.result=t,this._release(!1)},e.prototype.addCommand=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i={commandClass:t,guard:e,hook:n};this._commandBins.push(i)},e.prototype.insertCommand=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i={commandClass:t,guard:e,hook:n};this._commandBins.unshift(i)},e}(r);t.QueueCommand=s,__reflect(s.prototype,"common.QueueCommand");var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class common.Context]"},e.prototype._onClear=function(){t.prototype._onClear.call(this)},e.prototype._isSameListener=function(e,n){return e&&e.commandClass&&n?e.commandClass===n:t.prototype._isSameListener.call(this,e,n)},e.prototype.sendNotification=function(t,e,n){if(void 0===n&&(n=null),this.enabled){var a=i.create(i);a.type=t,a.target=n,a.data=e,this.dispatchEventWidth(t,a),a.release()}},e}(t.EventDispatcher);t.Context=l,__reflect(l.prototype,"common.Context");var c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.toString=function(){return"[class common.Controller]"},n.prototype._notificationHandler=function(t,e){this.execute(e.commandClass,t.data,e.guard,e.hook)},n.prototype._onClear=function(){},n.prototype.register=function(e,n,i,a){void 0===i&&(i=null),void 0===a&&(a=null);var o={commandClass:n,guard:i,hook:a};t.context.addEventListener(e,this._notificationHandler,this,o)},n.prototype.unregister=function(e,n){var i={commandClass:n,guard:null,hook:null};t.context.removeEventListener(e,this._notificationHandler,i)},n.prototype.execute=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var a=new t;return a.execute(e,n,i)},n}(t.BaseObject);t.Controller=c,__reflect(c.prototype,"common.Controller"),t.context=l.getInstance(l),t.controller=c.getInstance(c);var u=[]}(common||(common={}));var player;!function(t){t.NotificationType={VOChange:"VOChange",DragonBonesAdd:"DragonBonesAdd",DragonBonesRemove:"DragonBonesRemove",DragonBonesChange:"DragonBonesChange",ArmatureAdd:"ArmatureAdd",ArmatureRemove:"ArmatureRemove",ArmatureChange:"ArmatureChange",AnimationStart:"AnimationStart",AnimationComplete:"AnimationComplete",AnimationChange:"AnimationChange"};var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){throw new Error},e}(common.Model);t.BaseModel=e,__reflect(e.prototype,"player.BaseModel");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){throw new Error},e}(common.View);t.BaseView=n,__reflect(n.prototype,"player.BaseView");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(common.Command);t.BaseCommand=i,__reflect(i.prototype,"player.BaseCommand");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.QueueCommand]"},e}(common.QueueCommand);t.QueueCommand=a,__reflect(a.prototype,"player.QueueCommand")}(player||(player={}));var player;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.factory=dragonBones.EgretFactory.factory,t._armatures=[],t._dragonBonesData=null,t._armature=null,t}return __extends(i,e),i.toString=function(){return"[class player.ApplicationModel]"},i.prototype._onClear=function(){},i.prototype.createArmature=function(e){if(!this._dragonBonesData)return null;var i=this.factory.buildArmatureDisplay(e,this._dragonBonesData.name);if(i){var a=n.create(n);return a.initialize(null,i,null),this._armatures.push(a),this.sendNotification(t.NotificationType.ArmatureAdd,a),a}return null},i.prototype.removeArmature=function(e){var n=this._armatures.indexOf(e);console.assert(n>=0),this.armature=null,this._armatures.splice(n,1),this.sendNotification(t.NotificationType.ArmatureRemove,e),e.release()},i.prototype.clearAllArmature=function(){for(var t=this._armatures.length;t--;){var e=this._armatures[t];this.removeArmature(e)}},i.prototype.changeArmature=function(t){if(this._dragonBonesData)if(this._armature&&this.removeArmature(this._armature),"number"==typeof t){var e=this._dragonBonesData.armatureNames;t%=e.length,0>t&&(t=e.length+t),this.armature=this.createArmature(e[t])}else this.armature=this.createArmature(t)},i.prototype.prevArmature=function(){this._dragonBonesData&&(this._armature?this.changeArmature(this._dragonBonesData.armatureNames.indexOf(this._armature.component.armature.name)-1):this.changeArmature(0))},i.prototype.nextArmature=function(){this._dragonBonesData&&(this._armature?this.changeArmature(this._dragonBonesData.armatureNames.indexOf(this._armature.component.armature.name)+1):this.changeArmature(0))},Object.defineProperty(i.prototype,"vo",{set:function(e){if(e){this.dragonBonesData=null,this.clearAllArmature(),this.factory.clear(!0);for(var n=null,i=0,a=e;i<a.length;i++){var o=a[i];if(n=this.factory.parseDragonBonesData(o.rawDragonBonesData))if(o.rawTextureAtlasDatas.length>0)for(var r=0,s=0,l=o.rawTextureAtlasDatas;s<l.length;s++){var c=l[s],u=o.textureAtlases[r];if(u){var h=new egret.Texture;h.bitmapData=new egret.BitmapData(u),this.factory.parseTextureAtlasData(c,h)}else this.factory.parseTextureAtlasData(c,null)}else this.factory.updateTextureAtlasData(n.name,o.textureAtlases.map(function(t){if(t){var e=new egret.Texture;return e.bitmapData=new egret.BitmapData(t),e}return null}))}this.sendNotification(t.NotificationType.VOChange,null),this.dragonBonesData=n}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dragonBonesData",{get:function(){return this._dragonBonesData},set:function(e){if(this._dragonBonesData!==e){this._armature&&this.removeArmature(this._armature),this.armature=null;var n=this._dragonBonesData;this._dragonBonesData=e,this.sendNotification(t.NotificationType.DragonBonesChange,n),this._dragonBonesData&&this._dragonBonesData.armatureNames.length>0&&(this._dragonBonesData.stage?this.armature=this.createArmature(this._dragonBonesData.stage.name):this.armature=this.createArmature(this._dragonBonesData.armatureNames[0]))}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},set:function(e){if(this._armature!==e){var n=this._armature;this._armature=e,this.sendNotification(t.NotificationType.ArmatureChange,n)}},enumerable:!0,configurable:!0}),i}(t.BaseModel);t.ApplicationModel=e,__reflect(e.prototype,"player.ApplicationModel");var n=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._animation=null,t}return __extends(n,e),n.toString=function(){return"[class player.ArmatureView]"},n.prototype._animationHandler=function(e){var n=e.eventObject;switch(e.type){case dragonBones.EventObject.FADE_IN:this.animation=n.animationState,this.sendNotification(t.NotificationType.AnimationStart,this._animation);break;case dragonBones.EventObject.COMPLETE:this.sendNotification(t.NotificationType.AnimationComplete,this._animation)}},n.prototype._onClear=function(){this.component&&(this.component.removeEvent(dragonBones.EventObject.FADE_IN,this._animationHandler,this),this.component.removeEvent(dragonBones.EventObject.COMPLETE,this._animationHandler,this),this.animation=null,this.component.dispose(!0))},n.prototype._onInitialize=function(t){this.component.addEvent(dragonBones.EventObject.FADE_IN,this._animationHandler,this),this.component.addEvent(dragonBones.EventObject.COMPLETE,this._animationHandler,this)},n.prototype.update=function(){},n.prototype.changeAnimation=function(t){if("number"==typeof t){var e=this.component.armature.armatureData.animationNames;t%=e.length,0>t&&(t=e.length+t),this.component.animation.fadeIn(e[t])}else this.component.animation.fadeIn(t)},n.prototype.prevAnimation=function(){if(this._animation){var t=this.component.armature.armatureData.animationNames;this.changeAnimation(t.indexOf(this._animation.name)-1)}else this.component.animation.play()},n.prototype.nextAnimation=function(){if(this._animation){var t=this.component.armature.armatureData.animationNames;this.changeAnimation(t.indexOf(this._animation.name)+1)}else this.component.animation.play()},n.prototype.playAnimation=function(){!this.component.animation.lastAnimationState||this.component.animation.lastAnimationState.isCompleted?this.component.animation.play():this.component.animation.lastAnimationState.play()},n.prototype.stopAnimation=function(){this.component.animation.lastAnimationState&&this.component.animation.lastAnimationState.stop()},Object.defineProperty(n.prototype,"animation",{get:function(){return this._animation},set:function(e){if(this._animation!==e){var n=this._animation;this._animation=e,n&&this._animation&&n.name===this._animation.name||this.sendNotification(t.NotificationType.AnimationChange,n)}},enumerable:!0,configurable:!0}),n}(t.BaseView);t.ArmatureView=n,__reflect(n.prototype,"player.ArmatureView")}(player||(player={}));var player;!function(t){function e(t){if(t.indexOf("?")>=0)for(var e={},n=void 0,i=/\+/g,a=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(i," "))},r=t.substring(1);n=a.exec(r);)e[o(n[1])]=o(n[2]);return null}function n(t){for(var e=JSON.parse(t),n={rawDragonBonesData:i(e.data),rawTextureAtlasDatas:[],textureAtlases:[]},a=0,o=e.textureAtlases;a<o.length;a++){var r=o[a],s=document.createElement("img");s.src="data:image/png;base64,"+r,n.textureAtlases.push(s)}return[n]}function i(t){for(var e=window.atob(t),n=e.length,i=new Uint8Array(n),a=0;n>a;++a)i[a]=e.charCodeAt(a);return i.buffer}function a(t,e){m=0,p.length=0,c={},u={},h={},d=e;for(var n=0,i=t.length;i>n;++n){var a=t[n],r=new FileReader;switch(a.loader=r,r.file=a,r.addEventListener("load",o),r.addEventListener("error",o),m++,a.type){case"image/png":r.readAsDataURL(a),console.log("Loading:",a.type,a.name);break;default:r.readAsText(a.slice(0,Math.min(100,a.size)))}}}function o(t){var e=t.target;switch(t.type){case"load":var n=e.file,i=e.result,a=n.baseName;"image/png"===n.type?(a=n.baseName=l(n.name),h[a]=n,console.log("Load complete:",n.type,n.name,a),e.removeEventListener("load",o),e.removeEventListener("error",o),m--,0===m&&r()):a?(console.log("Load complete:",n.type,n.name,a),e.removeEventListener("load",o),e.removeEventListener("error",o),m--,0===m&&r()):(a=n.baseName=l(n.name),0===i.indexOf("DBDT")?(c[a]=n,e.readAsArrayBuffer(n),console.log("Loading:",n.type,n.name)):i.indexOf("armature")>0?(c[a]=n,e.readAsText(n),console.log("Loading:",n.type,n.name)):i.indexOf("SubTexture")>0?(u[a]=n,e.readAsText(n),console.log("Loading:",n.type,n.name)):(e.removeEventListener("load",o),e.removeEventListener("error",o),m--,0===m&&r()));break;default:e.removeEventListener("load",o),e.removeEventListener("error",o),m--,0===m&&r()}}function r(){for(var t in c){for(var e=c[t],n=e.loader,i="string"==typeof n.result?JSON.parse(n.result):n.result,a={rawDragonBonesData:i,rawTextureAtlasDatas:[],textureAtlases:[]},o=t.split(".").shift(),r=s(o),l=0,u=r;l<u.length;l++){var m=u[l],g=m.loader,_=m.baseName.split(".").shift()+".png",f=JSON.parse(g.result);if(_ in h){var y=h[_],v=y.loader,A=document.createElement("img");A.src=v.result,a.rawTextureAtlasDatas.push(f),a.textureAtlases.push(A)}else a.rawTextureAtlasDatas.push(f),a.textureAtlases.push(null)}p.push(a)}d(p)}function s(t,e,n){void 0===e&&(e=null),void 0===n&&(n="texture");var i=null!==e?e:t,a=0,o=new Array,r=(i.length>0?i+(n?"_"+n:n):n)+".json";if(r in u)return o.push(u[r]),o;for(;;){if(i.length>0&&n.length>0)r=i+"_"+n+"_"+a++ +".json";else if(n.length>0)r=n+"_"+a++ +".json";else{if(!(i.length>0)){console.assert(!1);break}r=i+"_"+a++ +".json"}if(r in u)o.push(u[r]);else if(a>1)break}if(o.length>0||null!==e)return o;if(o=s(t,"",n),o.length>0)return o;if(a=t.lastIndexOf("_"),a>=0){if(e=t.substring(0,a),o=s(t,e,n),o.length>0)return o;if(o=s(t,e,""),o.length>0)return o}return o}function l(t){return t.indexOf("_ske.")>0?t=t.replace("_ske.","."):t.indexOf("_tex.")>0?t=t.replace("_tex.","_texture."):t.indexOf("_tex_")>0&&(t=t.replace("_tex_","_texture_")),t}t.getQueryString=e,t.getVOFromZlip=n;var c,u,h,d,m=0,p=[];t.loadFiles=a}(player||(player={}));var DragManager=function(){function t(){this.dragTarget=null,this._isDragMove=!1,this._helpPoint=new egret.Point,this._dragPosition=new egret.Point,this._dragOffset=new egret.Point,this._dragSpeed=new egret.Point}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.enableDrag=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._dragHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._dragHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this._dragHandler,this))},t.prototype.disableDrag=function(t){t&&(t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this._dragHandler,this),t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._dragHandler,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this._dragHandler,this),t.removeEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this))},t.prototype._dragHandler=function(e){switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:if(this.dragTarget)return;this.dragTarget=e.currentTarget,this.dragTarget.parent.globalToLocal(e.stageX,e.stageY,this._helpPoint),this._dragPosition.x=this.dragTarget.x,this._dragPosition.y=this.dragTarget.y,this._dragOffset.x=this._dragPosition.x-this._helpPoint.x,this._dragOffset.y=this._dragPosition.y-this._helpPoint.y,this._dragSpeed.x=0,this._dragSpeed.y=0,this.dragTarget.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._dragHandler,this);break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:case egret.TouchEvent.TOUCH_END:this.dragTarget&&(this.dragTarget.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this._dragHandler,this),this._isDragMove?this.dragTarget.dragSpeed=this._dragSpeed.clone():this.dragTarget.removeEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this),this.dragTarget.dispatchEventWith(t.DRAG_END),this.dragTarget=null),this._isDragMove=!1;break;case egret.TouchEvent.TOUCH_MOVE:if(this.dragTarget){this.dragTarget.parent.globalToLocal(e.stageX,e.stageY,this._helpPoint);var n=this._helpPoint.x+this._dragOffset.x,i=this._helpPoint.y+this._dragOffset.y;!this._isDragMove&&(Math.abs(this._dragPosition.x-n)>5||Math.abs(this._dragPosition.y-i)>5)&&(this._isDragMove=!0,this.dragTarget.dispatchEventWith(t.DRAG_BEGIN),this.dragTarget.addEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this)),this._isDragMove&&(this.dragTarget.parent.globalToLocal(e.stageX,e.stageY,this._helpPoint),this._dragPosition.x=n,this._dragPosition.y=i)}}},t.prototype._enterFrameHandler=function(e){var n=e.currentTarget;if(n===this.dragTarget)this._dragSpeed.x+=.5*(this._dragPosition.x-n.x-this._dragSpeed.x),this._dragSpeed.y+=.5*(this._dragPosition.y-n.y-this._dragSpeed.y),(n.x!==this._dragPosition.x||n.y!==this._dragPosition.y)&&(n.x=this._dragPosition.x,n.y=this._dragPosition.y,n.hasEventListener(t.DRAG_MOVE)&&n.dispatchEventWith(t.DRAG_MOVE));else{var i=n.dragSpeed;n.x+=i.x,n.y+=i.y,i.x*=.7,i.y*=.7,n.hasEventListener(t.DRAG_MOVE)&&n.dispatchEventWith(t.DRAG_MOVE),Math.abs(i.x)<1&&Math.abs(i.y)<1&&n.removeEventListener(egret.Event.ENTER_FRAME,this._enterFrameHandler,this)}},t.DRAG_BEGIN="dragBegin",t.DRAG_END="dragEnd",t.DRAG_MOVE="dragMove",t._instance=null,t}();__reflect(DragManager.prototype,"DragManager");var lang;!function(t){function e(e){switch(e.toLowerCase()){case"en-us":t.language=i.en_US;break;case"zh-cn":t.language=i.zh_CN;break;case"ru-fr":t.language=i.ru_RF;break;default:t.language=i.en_US}}function n(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o;if(o=t.language<e.length?e[t.language]:e[i.en_US],n.length>0)for(var r=0,s=n.length;s>r;++r)o=o.replace("{"+r+"}",n[r]);return o}var i;!function(t){t[t.en_US=0]="en_US",t[t.zh_CN=1]="zh_CN",t[t.ru_RF=2]="ru_RF"}(i=t.LanguageType||(t.LanguageType={})),t.language=i.en_US,t.setLanguageByString=e,t.get=n,t.None=["","",""],t.Tip={armature:["Armature","骨架","Armature"],animation:["Animation","动画","Animation"],qrcode:["Qr code","扫描二维码，在手机端查看","Qr code"]},t.Label={animationControl:["Animation Control","动画控制","Animation Control"],backgroundColor:["Background Color","背景色","Background Color"],grid:["Show Grid","显示网格","Show Grid"],info:["Infomation<br/>Animation {0}<br/>Bone {1}<br/>Slot {2}<br/>","信息<br/>动画 {0}<br/>骨骼 {1}<br/>插槽 {2}<br/>","Infomation<br/>Animation {0}<br/>Bone {1}<br/>Slot {2}<br/>"]}}(lang||(lang={}));var Main=function(t){function e(){var e=t.call(this)||this;return e.container=new egret.DisplayObjectContainer,e.armatureContainer=new egret.DisplayObjectContainer,e.lineH=new egret.Shape,e.lineV=new egret.Shape,e.grid=new egret.Bitmap,e._application=player.Application.getInstance(player.Application),e._skinView=player.SkinView.create(player.SkinView),e.addChild(e.container),e.container.addChild(e.grid),e.container.addChild(e.lineV),e.container.addChild(e.lineH),e.container.addChild(e.armatureContainer),e.lineH.graphics.lineStyle(1,0,1,!0),e.lineV.graphics.lineStyle(1,0,1,!0),e.lineH.graphics.moveTo(0,0),e.lineV.graphics.moveTo(0,0),e.lineH.graphics.lineTo(101,0),e.lineV.graphics.lineTo(0,101),e.grid.smoothing=!1,e.grid.fillMode=egret.BitmapFillMode.REPEAT,e.grid.bitmapData=new egret.BitmapData(document.getElementById("background")),e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e._application.initialize(player.ApplicationModel.getInstance(player.ApplicationModel),e,null),e._skinView.initialize(player.ApplicationModel.getInstance(player.ApplicationModel),e,null);var t=document.getElementById("data");t&&(e._application.model.vo=player.getVOFromZlip(t.innerHTML));var n=player.getQueryString(window.location.search);n&&(n.armature&&e._application.model.changeArmature(n.armature),e._application.model.armature&&n.animationName&&e._application.model.armature.changeAnimation(n.animationName))},e),e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var player;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._gridEnabled=!1,t._isDraged=!1,t._scaleType=3,t._stageWidth=0,t._stageHeight=0,t._stageWidthOffset=0,t._stageHeightOffset=0,t._stageScale=1,t._gridScale=3,t._time=0,t._timer=-1,t._stageScalePoint=new egret.Point,t}return __extends(n,e),n.toString=function(){return"[class player.Application]"},n.prototype._notificationHandler=function(e){switch(e.type){case t.NotificationType.ArmatureAdd:var n=e.data;n&&this.component.armatureContainer.addChild(n.component);break;case t.NotificationType.ArmatureRemove:var n=e.data;n&&this.component.armatureContainer.removeChild(n.component);break;case t.NotificationType.ArmatureChange:var n=this.model.armature;n&&(this.scaleToType(0),n.playAnimation());break;case t.NotificationType.AnimationComplete:}},n.prototype._resizeHandler=function(t){var e=this.component.stage.stageWidth,n=this.component.stage.stageHeight,i=this.component.grid.bitmapData.width*this.component.grid.scaleX,a=this.component.grid.bitmapData.height*this.component.grid.scaleY;this.component.lineH.scaleX=.01*e,this.component.lineV.scaleY=.01*n,this.component.grid.width=(e+i)/this.component.grid.scaleX,this.component.grid.height=(n+a)/this.component.grid.scaleY,this.setStageSize(this.component.stage.stageWidth,this.component.stage.stageHeight,this._stageWidthOffset,this._stageHeightOffset)},n.prototype._touchHandler=function(t){var e=this;switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._isDraged=!1,egret.Tween.removeTweens(this);break;case egret.TouchEvent.TOUCH_END:var i=(new Date).getTime();i-this._time<300?(this.scaleToType(this._scaleType+1),clearTimeout(this._timer)):this._isDraged||(clearTimeout(this._timer),this._timer=setTimeout(function(){e.model.armature&&e.model.armature.nextAnimation()},300),this.sendNotification(n.TOUCH_STAGE,null)),this._time=i;break;case DragManager.DRAG_MOVE:this._isDraged=!0,this._updateBackgroundPosition()}},n.prototype._getFormatScale=function(t){return t<n.MIN_SCALE?t=n.MIN_SCALE:t>n.MAX_SCALE&&(t=n.MAX_SCALE),t},n.prototype._updateBackgroundPosition=function(){var t=this.component.container,e=this.component.grid,n=e.bitmapData.width*e.scaleX,i=e.bitmapData.height*e.scaleY;this.component.lineH.x=-t.x,this.component.lineV.y=-t.y,e.x=-Math.ceil(t.x/n)*n,e.y=-Math.ceil(t.y/i)*i},n.prototype._onInitialize=function(){var e=this;if(this.addNotification(t.NotificationType.ArmatureAdd,this._notificationHandler),this.addNotification(t.NotificationType.ArmatureRemove,this._notificationHandler),this.addNotification(t.NotificationType.ArmatureChange,this._notificationHandler),this.addNotification(t.NotificationType.AnimationComplete,this._notificationHandler),this.component.container.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHandler,this),this.component.container.addEventListener(egret.TouchEvent.TOUCH_END,this._touchHandler,this),this.component.container.addEventListener(DragManager.DRAG_MOVE,this._touchHandler,this),this.component.stage.addEventListener(egret.Event.RESIZE,this._resizeHandler,this),document.addEventListener("mousewheel",function(t){if(!(t.x<0||t.x>0+e.viewStageWidth||t.y<0||t.y>0+e.viewStageHeight)){var n=e.component.container;if(t.wheelDelta>0){var i=e._getFormatScale(1.2*e.stageScale);e.stageScale!==i&&(e._stageScalePoint.x=t.x-n.x,e._stageScalePoint.y=t.y-n.y,e._stageScalePoint.x=n.x+(e._stageScalePoint.x-e._stageScalePoint.x/e.stageScale*i),e._stageScalePoint.y=n.y+(e._stageScalePoint.y-e._stageScalePoint.y/e.stageScale*i),e.scaleTo(i,e._stageScalePoint))}else{var i=e._getFormatScale(.8*e.stageScale);e.stageScale!==i&&(e._stageScalePoint.x=e.viewStageWidth-t.x,e._stageScalePoint.y=e.viewStageHeight-t.y,e._stageScalePoint.x=n.x+.2*(e._stageScalePoint.x-n.x),e._stageScalePoint.y=n.y+.2*(e._stageScalePoint.y-n.y),e.scaleTo(i,e._stageScalePoint))}}}),!egret.Capabilities.isMobile){var n=document.body;n.ondragenter=n.ondragover=function(t){t.stopPropagation(),t.preventDefault()},n.ondrop=function(n){n.stopPropagation(),n.preventDefault();var i=n.dataTransfer;i&&i.files&&t.loadFiles(i.files,function(t){e.model.vo=t})}}DragManager.getInstance().enableDrag(this.component.container),this.gridEnabled=!0,this._resizeHandler(null),this.scaleToType(1,0)},n.prototype.update=function(){},n.prototype.setStageSize=function(t,e,n,i){var a=this.viewStageWidth||1,o=this.viewStageHeight||1;this._stageWidth=t,this._stageHeight=e,this._stageWidthOffset=n,this._stageHeightOffset=i,egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.component.container),egret.Tween.get(this.component.container,{onChange:this._updateBackgroundPosition,onChangeObj:this}).to({x:this.viewStageWidth*this.component.container.x/a,y:this.viewStageHeight*this.component.container.y/o},300,egret.Ease.cubicOut)},n.prototype.scaleTo=function(t,e,n){void 0===n&&(n=500),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.component.container),egret.Tween.get(this).to({stageScale:t},n,egret.Ease.cubicOut),e&&egret.Tween.get(this.component.container,{onChange:this._updateBackgroundPosition,onChangeObj:this}).to({x:e.x,y:e.y},n,egret.Ease.cubicOut)},n.prototype.scaleToType=function(t,e){void 0===e&&(e=500),this._scaleType=t,3===this._scaleType&&(this._scaleType=0);var n=1,i=this.model.armature;if(i){var a=i.component.getBounds(),o=this.viewStageWidth/this.viewStageHeight,r=a.width/a.height;switch(this._scaleType){case 0:break;case 1:n=o>r?this.viewStageHeight/(a.height+100):this.viewStageWidth/(a.width+100);break;case 2:n=o>r?this.viewStageWidth/(a.width+100):this.viewStageHeight/(a.height+100)}this._stageScalePoint.x=.5*this.viewStageWidth-(a.x+.5*a.width)*n,this._stageScalePoint.y=.5*this.viewStageHeight-(a.y+.5*a.height)*n}else this._stageScalePoint.x=.5*this.viewStageWidth,this._stageScalePoint.y=.5*this.viewStageHeight;this.scaleTo(n,this._stageScalePoint,e)},Object.defineProperty(n.prototype,"gridEnabled",{get:function(){return this._gridEnabled},set:function(t){this._gridEnabled!==t&&(this._gridEnabled=t,this._gridEnabled?(this.component.grid.alpha=.1,this.component.lineH.visible=!0,this.component.lineV.visible=!0):(this.component.grid.alpha=0,this.component.lineH.visible=!1,this.component.lineV.visible=!1))
},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stageWidth",{get:function(){return this._stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stageHeight",{get:function(){return this._stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewStageWidth",{get:function(){return Math.max(this._stageWidth+this._stageWidthOffset,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewStageHeight",{get:function(){return Math.max(this._stageHeight+this._stageHeightOffset,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stageScale",{get:function(){return this._stageScale},set:function(t){t=this._getFormatScale(t),this._stageScale=t,this.component.armatureContainer.scaleX=this.component.armatureContainer.scaleY=this._stageScale;var e=Math.max(this._stageScale*this._gridScale,.2),n=this.component.grid,i=n.bitmapData.width*e,a=n.bitmapData.height*e;n.scaleX=n.scaleY=e,n.width=(this.stageWidth+i)/e,n.height=(this.stageHeight+a)/e,this._updateBackgroundPosition()},enumerable:!0,configurable:!0}),n.MAX_SCALE=25,n.MIN_SCALE=.1,n.TOUCH_STAGE="touchStage",n}(t.BaseView);t.Application=e,__reflect(e.prototype,"player.Application")}(player||(player={}));var player;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._showSkin=!1,t._sideValue=-n.SKIN_WIDTH,t._speeds=[.1,.25,.5,1,1.5,2,4,8],t._dragonBonesPlayer=null,t._skin=null,t._skinButton=null,t._dataList=null,t._armatureList=null,t._animationList=null,t._prevArmatureButton=null,t._nextArmatureButton=null,t._prevAnimationButton=null,t._nextAnimationButton=null,t._stopAnimationButton=null,t._playAnimationButton=null,t._animationSpeedLabel=null,t._reduceAnimationSpeedButton=null,t._increaseAnimationSpeedButton=null,t._gridEnabledButton=null,t}return __extends(n,e),n.toString=function(){return"[class player.SkinView]"},n.prototype._notificationHandler=function(e){switch(e.type){case t.NotificationType.VOChange:this._updateDataList(!0);break;case t.NotificationType.DragonBonesChange:this._updateDataList(!1),this._updateArmatureList(!0);break;case t.NotificationType.ArmatureChange:this._updateArmatureList(!1),this._updateAnimationList(!0),this._updateAnimationSpeedLabel(),this._updateArmatureAndAnimationInfo();var n=e.data;n&&(n.component.removeEventListener(dragonBones.EventObject.START,this._animationHandler,this),n.component.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,this._animationHandler,this),n.component.removeEventListener(dragonBones.EventObject.COMPLETE,this._animationHandler,this),n.component.removeEventListener(dragonBones.EventObject.FRAME_EVENT,this._animationHandler,this)),this.model.armature&&(this.model.armature.component.addEventListener(dragonBones.EventObject.START,this._animationHandler,this),this.model.armature.component.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,this._animationHandler,this),this.model.armature.component.addEventListener(dragonBones.EventObject.COMPLETE,this._animationHandler,this),this.model.armature.component.addEventListener(dragonBones.EventObject.FRAME_EVENT,this._animationHandler,this));break;case t.NotificationType.AnimationChange:this._updateAnimationList(!1),this._updateArmatureAndAnimationInfo();break;case t.NotificationType.AnimationStart:this._updatePlayAndStopButton();break;case t.NotificationType.AnimationComplete:this._updatePlayAndStopButton();break;case t.Application.TOUCH_STAGE:egret.Capabilities.isMobile&&(this.showSkin=!1)}},n.prototype._animationHandler=function(t){var e=t.eventObject,n="";switch(e.type){case dragonBones.EventObject.FRAME_EVENT:n="[Frame event] "+e.animationState.name+" "+e.name;break;case dragonBones.EventObject.SOUND_EVENT:n="[Sound event] "+e.animationState.name+" "+e.name;break;default:n="[Animation event] "+e.animationState.name+" "+e.type}console.info(n)},n.prototype._updateElementLanguage=function(t,e){var n=document.getElementById(e);n&&(n.innerHTML=lang.get(t))},n.prototype._updateDataList=function(t){if(this._dataList)if(t){this._dataList.innerHTML="";for(var e in this.model.factory.getAllDragonBonesData()){var n=document.createElement("option");n.value=e,n.innerHTML=e,this._dataList.appendChild(n)}}else this.model.dragonBonesData?this._dataList.value=this.model.dragonBonesData.name:this._dataList.selectedIndex=-1},n.prototype._updateArmatureList=function(t){if(this._armatureList)if(this.model.dragonBonesData){var e=this.model.dragonBonesData.armatureNames;if(t){this._armatureList.innerHTML="";for(var n=0,i=e;n<i.length;n++){var a=i[n],o=document.createElement("option");o.value=a,o.innerHTML=a,this._armatureList.appendChild(o)}}else this.model.armature?this._armatureList.value=this.model.armature.component.armature.name:this._armatureList.selectedIndex=-1}else this._armatureList.innerHTML=""},n.prototype._updateAnimationList=function(t){if(this._animationList)if(this.model.armature){var e=this.model.armature.component.animation.animationNames;if(t){this._animationList.innerHTML="";for(var n=0,i=e;n<i.length;n++){var a=i[n],o=document.createElement("option");o.value=a,o.innerHTML=a,this._animationList.appendChild(o)}}else this.model.armature.animation?this._animationList.value=this.model.armature.animation.name:this._animationList.selectedIndex=-1}else this._animationList.innerHTML=""},n.prototype._updatePlayAndStopButton=function(){this.model.armature&&this.model.armature.component.animation.isPlaying?(this._stopAnimationButton&&(this._stopAnimationButton.style.display="none"),this._playAnimationButton&&(this._playAnimationButton.style.display="block")):(this._stopAnimationButton&&(this._stopAnimationButton.style.display="block"),this._playAnimationButton&&(this._playAnimationButton.style.display="none"))},n.prototype._updateAnimationSpeedLabel=function(){this.model.armature&&this._animationSpeedLabel&&(this._animationSpeedLabel.innerHTML="X "+this.model.armature.component.animation.timeScale.toFixed(2))},n.prototype._updateGridEnabled=function(){this._gridEnabledButton&&(t.Application.getInstance(t.Application).gridEnabled?this._gridEnabledButton.className="item selected":this._gridEnabledButton.className="item unselected")},n.prototype._updateArmatureAndAnimationInfo=function(){var t=document.getElementById("infoLabel");if(t){var e=this.model.armature;if(e){var n=e.animation;if(n){var i=e.component.armature.armatureData;return void(t.innerHTML=lang.get(lang.Label.info,i.animationNames.length,i.sortedBones.length,i.sortedSlots.length))}}this._updateElementLanguage(lang.None,"infoLabel")}},n.prototype._updateStageSize=function(){egret.Capabilities.isMobile||t.Application.getInstance(t.Application).setStageSize(this._dragonBonesPlayer.clientWidth,this._dragonBonesPlayer.clientHeight,-this._sideValue,0)},n.prototype._onInitialize=function(){var e=this;this.addNotification(t.NotificationType.VOChange,this._notificationHandler),this.addNotification(t.NotificationType.DragonBonesChange,this._notificationHandler),this.addNotification(t.NotificationType.ArmatureChange,this._notificationHandler),this.addNotification(t.NotificationType.AnimationChange,this._notificationHandler),this.addNotification(t.NotificationType.AnimationStart,this._notificationHandler),this.addNotification(t.NotificationType.AnimationComplete,this._notificationHandler),this.addNotification(t.Application.TOUCH_STAGE,this._notificationHandler),this.model.factory.soundEventManager.addEventListener(dragonBones.EventObject.SOUND_EVENT,this._animationHandler,this),lang.setLanguageByString(navigator.language),this._dragonBonesPlayer=document.getElementById("dragonBonesPlayer"),this._skin=document.getElementById("skin"),this._skinButton=document.getElementById("skinButton"),this._dataList=document.getElementById("dataList"),this._armatureList=document.getElementById("armatureList"),this._animationList=document.getElementById("animationList"),this._prevArmatureButton=document.getElementById("prevArmatureButton"),this._nextArmatureButton=document.getElementById("nextArmatureButton"),this._prevAnimationButton=document.getElementById("prevAnimationButton"),this._nextAnimationButton=document.getElementById("nextAnimationButton"),this._stopAnimationButton=document.getElementById("playAnimationButton"),this._playAnimationButton=document.getElementById("stopAnimationButton"),this._animationSpeedLabel=document.getElementById("animationSpeedLabel"),this._reduceAnimationSpeedButton=document.getElementById("reduceAnimationSpeedButton"),this._increaseAnimationSpeedButton=document.getElementById("increaseAnimationSpeedButton"),this._gridEnabledButton=document.getElementById("gridEnabledButton"),this._armatureList&&(this._armatureList.onchange=function(){e._armatureList&&e.model.changeArmature(e._armatureList.selectedIndex)}),this._dataList&&(this._dataList.onchange=function(){if(e._dataList){var t=e._dataList.children.item(e._dataList.selectedIndex);e.model.dragonBonesData=e.model.factory.getDragonBonesData(t.innerHTML)}}),this._animationList&&(this._animationList.onchange=function(){e._animationList&&e.model.armature&&e.model.armature.changeAnimation(e._animationList.selectedIndex)}),this._prevArmatureButton&&(this._prevArmatureButton.onclick=function(){e.model.prevArmature()}),this._nextArmatureButton&&(this._nextArmatureButton.onclick=function(){e.model.nextArmature()}),this._prevAnimationButton&&(this._prevAnimationButton.onclick=function(){e.model.armature&&(e.model.armature.stopAnimation(),e.model.armature.animation&&(e.model.armature.animation.currentTime-=1/e.model.armature.component.armature.armatureData.frameRate))}),this._nextAnimationButton&&(this._nextAnimationButton.onclick=function(){e.model.armature&&(e.model.armature.stopAnimation(),e.model.armature.animation&&(e.model.armature.animation.currentTime+=1/e.model.armature.component.armature.armatureData.frameRate))}),this._stopAnimationButton&&(this._stopAnimationButton.onclick=function(){e.model.armature&&(e.model.armature.playAnimation(),e._updatePlayAndStopButton())}),this._playAnimationButton&&(this._playAnimationButton.onclick=function(){e.model.armature&&(e.model.armature.stopAnimation(),e._updatePlayAndStopButton())}),this._reduceAnimationSpeedButton&&(this._reduceAnimationSpeedButton.onclick=function(){if(e.model.armature){var t=e._speeds.indexOf(e.model.armature.component.animation.timeScale)-1;0>t&&(t=0),e.model.armature.component.animation.timeScale=e._speeds[t],e._updateAnimationSpeedLabel()}}),this._increaseAnimationSpeedButton&&(this._increaseAnimationSpeedButton.onclick=function(){if(e.model.armature){var t=e._speeds.indexOf(e.model.armature.component.animation.timeScale)+1;t>=e._speeds.length&&(t=e._speeds.length-1),e.model.armature.component.animation.timeScale=e._speeds[t],e._updateAnimationSpeedLabel()}}),this._gridEnabledButton&&(this._gridEnabledButton.onclick=function(){t.Application.getInstance(t.Application).gridEnabled=!t.Application.getInstance(t.Application).gridEnabled,e._updateGridEnabled()}),this._skinButton.onclick=function(){e.showSkin=!e.showSkin},this._updateArmatureList(!0),this._updateArmatureList(!1),this._updateAnimationList(!0),this._updateAnimationList(!1),this._updatePlayAndStopButton(),this._updateAnimationSpeedLabel(),this._updateGridEnabled(),this._updateArmatureAndAnimationInfo(),this._updateElementLanguage(lang.Label.animationControl,"animationControlLabel"),this._updateElementLanguage(lang.Label.backgroundColor,"backgroundColorLabel"),this._updateElementLanguage(lang.Label.grid,"gridLabel");var n=document.getElementById("backgroundColor");if(this._dragonBonesPlayer&&n)for(var i=function(t,i){var a=n.children.item(t);a.onclick=function(){e._dragonBonesPlayer.style.backgroundColor=a.style.backgroundColor}},a=0,o=n.children.length;o>a;++a)i(a,o);var r=document.getElementById("qrCodeGroup");if(r)if(egret.Capabilities.isMobile)r&&(r.style.display="none");else{var s=document.getElementById("data");s&&new QRCode(document.getElementById("qrCode"),{width:120,height:120}).makeCode(window.location.href)}this.showSkin=!0},n.prototype.update=function(){},Object.defineProperty(n.prototype,"showSkin",{get:function(){return this._showSkin},set:function(t){this._showSkin!==t&&(this._showSkin=t,egret.Tween.get(this).to({sideValue:this._showSkin?n.SKIN_WIDTH:0},300,egret.Ease.cubicOut).call(this._updateStageSize,this))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sideValue",{get:function(){return this._sideValue},set:function(t){this._sideValue!==t&&(this._sideValue=t,this._skin.style.right=this._sideValue-n.SKIN_WIDTH+"px",this._skinButton.style.right=this._sideValue+"px")},enumerable:!0,configurable:!0}),n.SKIN_WIDTH=260,n}(t.BaseView);t.SkinView=e,__reflect(e.prototype,"player.SkinView")}(player||(player={}));